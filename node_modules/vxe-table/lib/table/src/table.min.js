"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../tools/dom"),_utils=require("../../tools/utils"),_log=require("../../tools/log"),_resize=require("../../tools/resize"),_event=require("../../tools/event"),_size=require("../../hooks/size"),_vXETable=require("../../v-x-e-table"),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("../../header")),_footer=_interopRequireDefault(require("../../footer")),_props=_interopRequireDefault(require("./props")),_emits=_interopRequireDefault(require("./emits")),_index=_interopRequireDefault(require("../../loading/index")),_util=require("./util"),_vn=require("../../tools/vn");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,l=1,n=arguments.length;l<n;l++)for(var r in t=arguments[l])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__spreadArray=function(e,t,l){if(l||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||((n=n||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},isWebkit=_dom.browse["-webkit"]&&!_dom.browse.edge,resizableStorageKey="VXE_TABLE_CUSTOM_COLUMN_WIDTH",visibleStorageKey="VXE_TABLE_CUSTOM_COLUMN_VISIBLE",fixedStorageKey="VXE_TABLE_CUSTOM_COLUMN_FIXED",orderStorageKey="VXE_TABLE_CUSTOM_COLUMN_ORDER",_default=(0,_vue.defineComponent)({name:"VxeTable",props:_props.default,emits:_emits.default,setup:function(P,e){function p(e,t,l){return e=_xeUtils.default.get(e,l),t=_xeUtils.default.get(t,l),!(!(0,_utils.eqEmptyValue)(e)||!(0,_utils.eqEmptyValue)(t))||(_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?""+e==""+t:_xeUtils.default.isEqual(e,t))}function c(e){var t=T.value.orders,e=e.order||null,e=t.indexOf(e)+1;return t[e<t.length?e:0]}function t(e,a,i){var t,u;e&&(t=P.treeConfig,u=X.visibleColumn,_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(function(e){var t,l,n=e.row,r=e.col,o=e.rowspan,e=e.colspan;i&&_xeUtils.default.isNumber(n)&&(n=i[n]),_xeUtils.default.isNumber(r)&&(r=u[r]),(i?n:_xeUtils.default.isNumber(n))&&r&&(o||e)&&(o=_xeUtils.default.toNumber(o)||1,e=_xeUtils.default.toNumber(e)||1,1<o||1<e)&&(t=_xeUtils.default.findIndexOf(a,function(e){return!(e._row!==n&&(0,_util.getRowid)(le,e._row)!==(0,_util.getRowid)(le,n)||e._col.id!==r&&e._col.id!==r.id)}),(t=a[t])?(t.rowspan=o,t.colspan=e,t._rowspan=o,t._colspan=e):(t=i?le.findRowIndexOf(i,n):n,l=W.getVTColumnIndex(r),a.push({row:t,col:l,rowspan:o,colspan:e,_row:n,_col:r,_rowspan:o,_colspan:e})))}))}function l(e,n,r){var t,o,a=[];return e&&(t=P.treeConfig,o=X.visibleColumn,_xeUtils.default.isArray(e)||(e=[e]),t&&e.length&&(0,_log.errLog)("vxe.error.noTree",["merge-cells | merge-footer-items"]),e.forEach(function(e){var t=e.row,l=e.col,e=(r&&_xeUtils.default.isNumber(t)&&(t=r[t]),_xeUtils.default.isNumber(l)&&(l=o[l]),_xeUtils.default.findIndexOf(n,function(e){return!(e._row!==t&&(0,_util.getRowid)(le,e._row)!==(0,_util.getRowid)(le,t)||e._col.id!==l&&e._col.id!==l.id)}));-1<e&&(e=n.splice(e,1),a.push(e[0]))})),a}function i(){X.tableFullColumn.forEach(function(e){e.order=null})}function _(){function a(e,t,l,n,r){var o=e.id,a=e.field,i=e.fixed,u=e.type,c=e.treeNode,t={column:e,colid:o,index:t,items:l,parent:r};a&&("development"===process.env.NODE_ENV&&_[a]&&(0,_log.warnLog)("vxe.error.colRepet",["field",a]),_[a]=t),!h&&i&&(h=i),g||"html"!==u||(g=e),c?("development"===process.env.NODE_ENV&&s&&(0,_log.warnLog)("vxe.error.colRepet",["tree-node",c]),s=s||e):"expand"===u&&("development"===process.env.NODE_ENV&&d&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),d=d||e),"development"===process.env.NODE_ENV&&("checkbox"===u?(f&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),f=f||e):"radio"===u&&(v&&(0,_log.warnLog)("vxe.error.colRepet",["type",u]),v=v||e)),m&&!1===e.showOverflow&&(m=!1),p[o]&&(0,_log.errLog)("vxe.error.colRepet",["colId",o]),p[o]=t}var d,s,f,v,g,h,e=X.tableFullColumn,t=X.collectColumn,p=X.fullColumnIdData={},_=X.fullColumnFieldData={},l=Q.value,n=G.value,r=Z.value,o=t.some(_utils.hasChildrenList),m=!!P.showOverflow;o?_xeUtils.default.eachTree(t,function(e,t,l,n,r,o){e.level=o.length,a(e,t,l,0,r)}):e.forEach(a),"development"===process.env.NODE_ENV&&d&&l.area&&(0,_log.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),"development"===process.env.NODE_ENV&&g&&(n.useKey||(0,_log.errLog)("vxe.error.reqProp",["column-config.useKey","column.type=html"]),r.useKey||(0,_log.errLog)("vxe.error.reqProp",["row-config.useKey","column.type=html"])),K.isGroup=o,K.treeNodeColumn=s,K.expandColumn=d,K.isAllOverflow=m}function D(){X.customHeight=xt("height"),X.customMinHeight=xt("minHeight"),X.customMaxHeight=xt("maxHeight")}function n(){var e=$.value,t=j.value,l=Y.value,n=t?t.$el:null,r=e?e.$el:null,t=l?l.$el:null;if(n){var o=0,e=n.clientWidth-1,l=e,a=l/100,i=P.fit,u=K.columnStore,c=u.resizeList,d=u.pxMinList,s=u.pxList,f=u.scaleList,v=u.scaleMinList,u=u.autoList;if(d.forEach(function(e){var t=_xeUtils.default.toInteger(e.minWidth);o+=t,e.renderWidth=t}),v.forEach(function(e){var t=Math.floor(_xeUtils.default.toInteger(e.minWidth)*a);o+=t,e.renderWidth=t}),f.forEach(function(e){var t=Math.floor(_xeUtils.default.toInteger(e.width)*a);o+=t,e.renderWidth=t}),s.forEach(function(e){var t=_xeUtils.default.toInteger(e.width);o+=t,e.renderWidth=t}),c.forEach(function(e){var t=_xeUtils.default.toInteger(e.resizeWidth);o+=t,e.renderWidth=t}),a=0<(l-=o)?Math.floor(l/(v.length+d.length+u.length)):0,i?0<l&&v.concat(d).forEach(function(e){o+=a,e.renderWidth+=a}):a=40,u.forEach(function(e){var t=Math.max(a,40);e.renderWidth=t,o+=t}),i){var g=f.concat(v).concat(d).concat(u),h=g.length-1;if(0<h){var p=e-o;if(0<p){for(;0<p&&0<=h;)p--,g[h--].renderWidth++;o=e}}}s=n.offsetHeight,c=n.scrollHeight>n.clientHeight,l=0,i=(c&&(l=Math.max(n.offsetWidth-n.clientWidth,0)),K.scrollbarWidth=l,K.overflowY=c,X.tableWidth=o,X.tableHeight=s,0),f=(r&&(i=r.clientHeight,(0,_vue.nextTick)(function(){r&&n&&r.scrollLeft!==n.scrollLeft&&(r.scrollLeft=n.scrollLeft)})),X.headerHeight=i,!1),v=0,d=0;t?(v=t.offsetHeight,(f=o>t.clientWidth)&&(d=Math.max(v-t.clientHeight,0))):(f=e<o)&&(d=Math.max(s-n.clientHeight,0)),X.footerHeight=v,K.overflowX=f,K.scrollbarHeight=d,D(),K.parentHeight=Math.max(X.headerHeight+v+20,H.getParentHeight()),f&&H.checkScrolling()}}function M(t){var l=t.sortBy,n=t.sortType;return function(e){e=l?_xeUtils.default.isFunction(l)?l({row:e,column:t}):_xeUtils.default.get(e,l):H.getCellLabel(e,t);return n&&"auto"!==n?"number"===n?_xeUtils.default.toNumber(e):"string"===n?_xeUtils.default.toValueString(e):e:isNaN(e)?e:_xeUtils.default.toNumber(e)}}function k(){var e=P.treeConfig,t=X.afterFullData,a=X.fullDataRowIdData,i=X.fullAllDataRowIdData,l=X.afterTreeFullData,n=te.value,r=n.children||n.childrenField,u={};e?_xeUtils.default.eachTree(l,function(e,t,l,n){var r=(0,_util.getRowid)(le,e),o=i[r],n=n.map(function(e,t){return t%2==0?Number(e)+1:"."}).join("");o?(o.seq=n,o._index=t):(i[r]=o={row:e,rowid:r,seq:n,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},a[r]=o),u[r]=e},{children:n.transform?n.mapChildrenField:r}):t.forEach(function(e,t){var l=(0,_util.getRowid)(le,e),n=i[l],r=t+1;n?(n.seq=r,n._index=t):(i[l]=n={row:e,rowid:l,seq:r,index:-1,$index:-1,_index:t,items:[],parent:null,level:0},a[l]=n),u[l]=e}),X.afterFullRowMaps=u}function b(){var i,u,e=P.treeConfig,c=K.treeExpandedMaps,t=te.value;return e&&t.transform?(i=[],u={},_xeUtils.default.eachTree(X.afterTreeFullData,function(e,t,l,n,r){var o=(0,_util.getRowid)(le,e),a=(0,_util.getRowid)(le,r);(!r||u[a]&&c[a])&&(u[o]=1,i.push(e))},{children:t.mapChildrenField}),X.afterFullData=i,re(i),i):X.afterFullData}function a(e){return le.triggerValidate?le.triggerValidate(e):(0,_vue.nextTick)()}function I(e,t){a("blur").catch(function(e){return e}).then(function(){le.handleActived(t,e).then(function(){return a("change")}).catch(function(e){return e})})}function C(e,t){var l,n=X.checkboxReserveRowMap;R.value.reserve&&(l=(0,_util.getRowid)(le,e),t?n[l]=e:n[l]&&delete n[l])}function m(a){return new Promise(function(t){var e,l,n,r,o=y.value.loadMethod;o?(e=X.fullAllDataRowIdData,l=K.rowExpandLazyLoadedMaps,n=(0,_util.getRowid)(le,a),r=e[n],l[n]=a,o({$table:le,row:a,rowIndex:W.getRowIndex(a),$rowIndex:W.getVMRowIndex(a)}).then(function(){var e=K.rowExpandedMaps;r.expandLoaded=!0,e[n]=a}).catch(function(){r.expandLoaded=!1}).finally(function(){var e=K.rowExpandLazyLoadedMaps;e[n]&&delete e[n],(0,_vue.nextTick)().then(function(){return W.recalculate()}).then(function(){return t()})})):t()})}function L(e,t){var l,n=X.rowExpandedReserveRowMap;y.value.reserve&&(l=(0,_util.getRowid)(le,e),t?n[l]=e:n[l]&&delete n[l])}function F(){return(0,_vue.nextTick)().then(function(){var e=K.scrollXLoad,t=K.scrollYLoad,l=X.scrollXStore,n=X.scrollYStore,r=x.value,o=qe.value,e=(e?(e=pt().visibleSize,o=o.oSize?_xeUtils.default.toNumber(o.oSize):_dom.browse.edge?5:0,l.offsetSize=o,l.visibleSize=e,l.endIndex=Math.max(l.startIndex+l.visibleSize+o,l.endIndex),H.updateScrollXData()):H.updateScrollXSpace(),_t()),o=e.rowHeight,l=e.visibleSize;n.rowHeight=o,t?(e=r.oSize?_xeUtils.default.toNumber(r.oSize):_dom.browse.edge?10:0,n.offsetSize=e,n.visibleSize=l,n.endIndex=Math.max(n.startIndex+l+e,n.endIndex),H.updateScrollYData()):H.updateScrollYSpace(),K.rowHeight=o,(0,_vue.nextTick)(w)})}function U(e){var t=P.keepSource,l=P.treeConfig,n=K.editStore,g=K.scrollYLoad,h=X.scrollYStore,r=X.scrollXStore,p=X.lastScrollLeft,_=X.lastScrollTop,o=te.value,a=o.transform,i=o.children||o.childrenField,u=[],c=(0,_vue.reactive)(e?e.slice(0):[]),m=(l&&(a?("development"===process.env.NODE_ENV&&(o.rowField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.rowField"]),o.parentField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.parentField"]),i||(0,_log.errLog)("vxe.error.reqProp",["tree-config.childrenField"]),o.mapChildrenField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.mapChildrenField"]),i===o.mapChildrenField)&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config.childrenField","tree-config.mapChildrenField"]),c=(u=_xeUtils.default.toArrayTree(c,{key:o.rowField,parentKey:o.parentField,children:i,mapChildren:o.mapChildrenField})).slice(0)):u=c.slice(0)),h.startIndex=0,h.endIndex=1,r.startIndex=0,r.endIndex=1,K.scrollVMLoading=!1,n.insertMaps={},n.removeMaps={},re(c));return K.scrollYLoad=m,X.tableFullData=c,X.tableFullTreeData=u,H.cacheRowMap(!0),X.tableSynchData=e,t&&H.cacheSourceMap(c),"development"===process.env.NODE_ENV&&m&&(P.height||P.maxHeight||(0,_log.errLog)("vxe.error.reqProp",["table.height | table.max-height | table.scroll-y={enabled: false}"]),P.showOverflow||(0,_log.warnLog)("vxe.error.reqProp",["table.show-overflow"]),P.spanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["table.span-method"]),le.clearCellAreas&&P.mouseConfig&&(le.clearCellAreas(),le.clearCopyCellArea()),W.clearMergeCells(),W.clearMergeFooterItems(),H.handleTableData(!0),W.updateFooter(),(0,_vue.nextTick)().then(function(){D(),w()}).then(function(){F()}).then(function(){var e,t,l,n,r,o,a,i,u,c,d,s,f,v;return m&&(h.endIndex=h.visibleSize),e=P.treeConfig,t=K.expandColumn,l=K.currentRow,n=K.selectCheckboxMaps,r=K.selectRadioRow,o=K.rowExpandedMaps,a=K.treeExpandedMaps,i=X.fullDataRowIdData,u=X.fullAllDataRowIdData,c=X.radioReserveRow,d=y.value,s=te.value,f=E.value,v=R.value,r&&!u[(0,_util.getRowid)(le,r)]&&(K.selectRadioRow=null),f.reserve&&c&&i[r=(0,_util.getRowid)(le,c)]&&wt(i[r].row,!0),K.selectCheckboxMaps=gt(n),v.reserve&&S(ht(X.checkboxReserveRowMap),!0,!0),l&&!u[(0,_util.getRowid)(le,l)]&&(K.currentRow=null),K.rowExpandedMaps=t?gt(o):{},t&&d.reserve&&W.setRowExpand(ht(X.rowExpandedReserveRowMap),!0),K.treeExpandedMaps=e?gt(a):{},e&&s.reserve&&W.setTreeExpand(ht(X.treeExpandedReserveRowMap),!0),H.checkSelectionStatus(),new Promise(function(r){(0,_vue.nextTick)().then(function(){return W.recalculate()}).then(function(){var e=p,t=_,l=qe.value,n=x.value;l.scrollToLeftOnChange&&(e=0),n.scrollToTopOnChange&&(t=0),g===m?(0,_util.restoreScrollLocation)(le,e,t).then(r):setTimeout(function(){return(0,_util.restoreScrollLocation)(le,e,t).then(r)})})})})}function O(){var t,l,e,n,r,o,a,i,u,c,d,s,f,v;P.checkboxConfig&&(t=X.fullDataRowIdData,n=(e=R.value).checkAll,e=e.checkRowKeys,n?bt(!0,!0):e&&(l=[],e.forEach(function(e){t[e]&&l.push(t[e].row)}),S(l,!0,!0))),P.radioConfig&&(n=X.fullDataRowIdData,o=(e=E.value).checkRowKey,e=e.reserve,o)&&(n[o]&&wt(n[o].row,!0),e)&&(n=(0,_util.getRowkey)(le),X.radioReserveRow=((e={})[n]=o,e)),P.expandConfig&&(r=X.fullDataRowIdData,u=(o=y.value).expandAll,o=o.expandRowKeys,u?W.setAllRowExpand(!0):o&&(a=[],o.forEach(function(e){r[e]&&a.push(r[e].row)}),W.setRowExpand(a,!0))),P.treeConfig&&(i=X.tableFullData,f=(u=te.value).expandAll,v=u.expandRowKeys,c=u.children||u.childrenField,f?W.setAllTreeExpand(!0):v&&(d=[],s=(0,_util.getRowkey)(le),v.forEach(function(t){var e=_xeUtils.default.findTree(i,function(e){return t===_xeUtils.default.get(e,s)},{children:c});e&&d.push(e.item)}),W.setTreeExpand(d,!0))),(f=P.mergeCells)&&W.setMergeCells(f),(v=P.mergeFooterItems)&&W.setMergeFooterItems(v),(0,_vue.nextTick)(function(){return setTimeout(function(){return W.recalculate()})})}function A(){var e,t,l;(l=P.sortConfig)&&(t=(e=T.value).defaultSort)&&(t=_xeUtils.default.isArray(t)?t:[t]).length&&((l.multiple?t:t.slice(0,1)).forEach(function(e,t){var l=e.field,e=e.order;l&&e&&(l=W.getColumnByField(l))&&l.sortable&&(l.order=e,l.sortTime=Date.now()+t)}),e.remote||H.handleTableData(!0).then(w))}function N(){var e=K.mergeList,t=K.mergeFooterList,l=X.scrollXStore,n=l.startIndex,r=l.endIndex,o=l.offsetSize,a=(i=pt()).toVisibleIndex,i=i.visibleSize,o={startIndex:Math.max(0,a-1-o),endIndex:a+i+o},e=(mt(e.concat(t),o,"col"),o.startIndex),t=o.endIndex;!(a<=n||r-i-1<=a)||n===e&&r===t||(l.startIndex=e,l.endIndex=t,H.updateScrollXData()),W.closeTooltip()}function ne(){var t,l,n,a=[],i=[],u=[],e=K.isGroup,r=K.columnStore,o=qe.value,c=X.collectColumn,d=X.tableFullColumn,s=X.scrollXStore,f=X.fullColumnIdData,v=(e?(t=[],l=[],n=[],_xeUtils.default.eachTree(c,function(e,t,l,n,r){var o=(0,_utils.hasChildrenList)(e);r&&r.fixed&&(e.fixed=r.fixed),r&&e.fixed!==r.fixed&&(0,_log.errLog)("vxe.error.groupFixed"),o?e.visible=!!_xeUtils.default.findTree(e.children,function(e){return!(0,_utils.hasChildrenList)(e)&&e.visible}):e.visible&&("left"===e.fixed?a:"right"===e.fixed?u:i).push(e)}),c.forEach(function(e){e.visible&&("left"===e.fixed?t:"right"===e.fixed?n:l).push(e)}),K.tableGroupColumn=t.concat(l).concat(n)):d.forEach(function(e){e.visible&&("left"===e.fixed?a:"right"===e.fixed?u:i).push(e)}),a.concat(i).concat(u)),e=!!o.enabled&&-1<o.gt&&(0===o.gt||o.gt<d.length);return K.hasFixedColumn=0<a.length||0<u.length,Object.assign(r,{leftList:a,centerList:i,rightList:u}),e&&("development"===process.env.NODE_ENV&&(P.showHeader&&!P.showHeaderOverflow&&(0,_log.warnLog)("vxe.error.reqProp",["show-header-overflow"]),P.showFooter&&!P.showFooterOverflow&&(0,_log.warnLog)("vxe.error.reqProp",["show-footer-overflow"]),P.spanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["span-method"]),P.footerSpanMethod)&&(0,_log.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]),c=pt().visibleSize,s.startIndex=0,s.endIndex=c,s.visibleSize=c),v.length===X.visibleColumn.length&&X.visibleColumn.every(function(e,t){return e===v[t]})||(W.clearMergeCells(),W.clearMergeFooterItems()),K.scrollXLoad=e,v.forEach(function(e,t){e=e.id,e=f[e];e&&(e._index=t)}),X.visibleColumn=v,Rt(),W.updateFooter().then(function(){return W.recalculate()}).then(function(){return W.updateCellAreas(),W.recalculate()})}function o(e){X.collectColumn=e;var l,o,t,n,r,a,i,u,c=Tt(e);return X.tableFullColumn=c,_(),c=P.id,t=P.customConfig,n=X.collectColumn,r=v.value.storage,a=!0===r||r&&r.resizable,i=!0===r||r&&r.visible,u=!0===r||r&&r.fixed,r=!0===r||r&&r.order,t&&(a||i||u||r)&&(l={},c?(a&&(t=g(resizableStorageKey)[c])&&_xeUtils.default.each(t,function(e,t){l[t]={resizeWidth:e}}),u&&(a=g(fixedStorageKey)[c])&&a.split(",").forEach(function(e){var e=e.split("|"),t=e[0],e=e[1];l[t]?l[t].fixed=e:l[t]={fixed:e}}),r&&g(orderStorageKey)[c],i&&(t=g(visibleStorageKey)[c])&&(a=(u=t.split("|"))[0]?u[0].split(","):[],r=u[1]?u[1].split(","):[],a.forEach(function(e){l[e]?l[e].visible=!1:l[e]={visible:!1}}),r.forEach(function(e){l[e]?l[e].visible=!0:l[e]={visible:!0}})),o={},_xeUtils.default.eachTree(n,function(e){var t=e.getKey();t&&(o[t]=e)}),_xeUtils.default.each(l,function(e,t){var l=e.visible,n=e.resizeWidth,r=e.fixed,e=e.order,t=o[t];t&&(_xeUtils.default.isNumber(n)&&(t.resizeWidth=n),_xeUtils.default.isBoolean(l)&&(t.visible=l),r&&(t.fixed=r),e)&&(t.customOrder=e)})):(0,_log.errLog)("vxe.error.reqProp",["id"])),ne().then(function(){K.scrollXLoad&&N()}),W.clearMergeCells(),W.clearMergeFooterItems(),H.handleTableData(!0),"development"===process.env.NODE_ENV&&(K.scrollXLoad||K.scrollYLoad)&&K.expandColumn&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(function(){return f&&f.syncUpdate({collectColumn:e,$table:le}),W.recalculate()})}function re(e){var t=P.treeConfig,l=x.value,n=te.value.transform,e=e||X.tableFullData,n=(n||!t)&&!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<e.length);return K.scrollYLoad=n}function u(e,t){var l=K.treeExpandedMaps,n=K.treeExpandLazyLoadedMaps,r=K.treeNodeColumn,o=__assign({},l),a=X.fullAllDataRowIdData,l=X.tableFullData,i=te.value,u=i.reserve,c=i.lazy,d=i.accordion,s=i.toggleMethod,f=i.children||i.childrenField,v=i.hasChild||i.hasChildField,g=[],h=W.getColumnIndex(r),p=W.getVMColumnIndex(r),_=s?e.filter(function(e){return s({$table:le,expanded:t,column:r,columnIndex:h,$columnIndex:p,row:e})}):e;return d&&(_=_.length?[_[_.length-1]]:[],i=_xeUtils.default.findTree(l,function(e){return e===_[0]},{children:f}))&&i.items.forEach(function(e){e=(0,_util.getRowid)(le,e);o[e]&&delete o[e]}),t?_.forEach(function(e){var t,l=(0,_util.getRowid)(le,e);o[l]||(t=a[l],c&&e[v]&&!t.treeLoaded&&!n[l]?g.push(Ct(e)):e[f]&&e[f].length&&(o[l]=e))}):_.forEach(function(e){e=(0,_util.getRowid)(le,e);o[e]&&delete o[e]}),u&&_.forEach(function(e){return Et(e,t)}),K.treeExpandedMaps=o,Promise.all(g).then(function(){return W.recalculate()})}function oe(e){var t=K.mergeList,l=X.scrollYStore,n=l.startIndex,r=l.endIndex,o=l.visibleSize,a=l.offsetSize,i=l.rowHeight,e=(e.currentTarget||e.target).scrollTop,e=Math.floor(e/i),i={startIndex:Math.max(0,e-1-a),endIndex:e+o+a},a=(mt(t,i,"row"),i.startIndex),t=i.endIndex;!(e<=n||r-o-1<=e)||n===a&&r===t||(l.startIndex=a,l.endIndex=t,H.updateScrollYData())}function ae(l){return function(e){var t=X.fullAllDataRowIdData;if(e){t=t[(0,_util.getRowid)(le,e)];if(t)return t[l]}return-1}}function ie(l){return function(e){var t=X.fullColumnIdData;if(e){t=t[e.id];if(t)return t[l]}return-1}}function ue(l){var e=K.editStore,t=K.ctxMenuStore,n=K.filterStore,r=P.mouseConfig,o=P.editRules,a=z.value,i=J.value,u=ze.value,c=e.actived,e=Se.value,d=De.value,s=Me.value;!d||(0,_dom.getEventTargetNode)(l,a,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(l,d.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||H.preventEvent(l,"event.clearFilter",n.args,W.closeFilter),c.row?!1===i.autoClear||(d=c.args.cell)&&(0,_dom.getEventTargetNode)(l,d).flag||e&&(0,_dom.getEventTargetNode)(l,e.$el).flag||X._lastCallTime&&!(X._lastCallTime+50<Date.now())||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||H.preventEvent(l,"event.clearActived",c.args,function(){var e,t;(e=(e=(e="row"===i.mode?!!(e=(e=(0,_dom.getEventTargetNode)(l,a,"vxe-body--row")).flag?W.getRowNode(e.targetElem):null)&&!le.eqRow(e.item,c.args.row):!(0,_dom.getEventTargetNode)(l,a,"col--edit").flag)||(0,_dom.getEventTargetNode)(l,a,"vxe-header--row").flag)||(0,_dom.getEventTargetNode)(l,a,"vxe-footer--row").flag)||!P.height||K.overflowY||(t=l.target,(0,_dom.hasClass)(t,"vxe-table--body-wrapper")&&(e=l.offsetY<t.clientHeight)),!e&&(0,_dom.getEventTargetNode)(l,a).flag||setTimeout(function(){return le.clearEdit(l)})}):!r||(0,_dom.getEventTargetNode)(l,a).flag||B&&(0,_dom.getEventTargetNode)(l,B.getRefMaps().refElem.value).flag||s&&(0,_dom.getEventTargetNode)(l,s.getRefMaps().refElem.value).flag||f&&(0,_dom.getEventTargetNode)(l,f.getRefMaps().refElem.value).flag||(le.clearSelected(),!le.clearCellAreas)||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-areas-clear").flag||H.preventEvent(l,"event.clearAreas",{},function(){le.clearCellAreas(),le.clearCopyCellArea()}),le.closeMenu&&t.visible&&s&&!(0,_dom.getEventTargetNode)(l,s.getRefMaps().refElem.value).flag&&le.closeMenu(),!(n=(0,_dom.getEventTargetNode)(l,B?B.getRefMaps().refElem.value:a).flag)&&o&&u.autoClear&&(K.validErrorMaps={}),X.isActivated=n}function ce(){W.closeFilter(),le.closeMenu&&le.closeMenu()}function de(){W.closeTooltip(),le.closeMenu&&le.closeMenu()}function se(t){var l=P.mouseConfig,n=P.keyboardConfig,r=K.filterStore,o=K.ctxMenuStore,e=K.editStore,a=Q.value,i=ee.value,u=e.actived;(0,_event.hasEventKey)(t,_event.EVENT_KEYS.ESCAPE)&&H.preventEvent(t,"event.keydown",null,function(){var e;W.dispatchEvent("keydown-start",{},t),n&&l&&a.area&&le.handleKeyboardEvent?le.handleKeyboardEvent(t):(u.row||r.visible||o.visible)&&(t.stopPropagation(),le.closeMenu&&le.closeMenu(),W.closeFilter(),n)&&i.isEsc&&u.row&&(e=u.args,le.clearEdit(t),a.selected)&&(0,_vue.nextTick)(function(){return le.handleSelected(e,t)}),W.dispatchEvent("keydown",{},t),W.dispatchEvent("keydown-end",{},t)})}function fe(q){X.isActivated&&H.preventEvent(q,"event.keydown",null,function(){var e,t,l,n,r=P.mouseConfig,o=P.keyboardConfig,a=P.treeConfig,i=P.editConfig,u=P.highlightCurrentRow,c=K.ctxMenuStore,d=K.editStore,s=K.currentRow,f=et.value,v=Je.value,g=ee.value,h=Q.value,p=J.value,_=te.value,m=tt.value,x=Z.value,w=d.selected,d=d.actived,_=_.children||_.childrenField,b=q.keyCode,C=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ESCAPE),E=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.BACKSPACE),A=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.TAB),R=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ENTER),T=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.SPACEBAR),y=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ARROW_LEFT),S=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ARROW_UP),D=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ARROW_RIGHT),M=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.ARROW_DOWN),k=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.DELETE),I=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.F2),N=(0,_event.hasEventKey)(q,_event.EVENT_KEYS.CONTEXT_MENU),V=q.metaKey,L=q.ctrlKey,F=q.shiftKey,z=q.altKey,U=y||S||D||M,f=f&&c.visible&&(R||T||U),O=(0,_utils.isEnableConf)(i)&&d.column&&d.row;f?(q.preventDefault(),c.showChild&&(0,_utils.hasChildrenList)(c.selected)?le.moveCtxMenu(q,c,"selectChild",y,!1,c.selected.children):le.moveCtxMenu(q,c,"selected",D,!0,m)):o&&r&&h.area&&le.handleKeyboardEvent?le.handleKeyboardEvent(q):C?(le.closeMenu&&le.closeMenu(),W.closeFilter(),o&&g.isEsc&&d.row&&(e=d.args,le.clearEdit(q),h.selected)&&(0,_vue.nextTick)(function(){return le.handleSelected(e,q)})):T&&o&&g.isChecked&&w.row&&w.column&&("checkbox"===w.column.type||"radio"===w.column.type)?(q.preventDefault(),"checkbox"===w.column.type?H.handleToggleCheckRowEvent(q,w.args):H.triggerRadioRowEvent(q,w.args)):I&&(0,_utils.isEnableConf)(i)?O||w.row&&w.column&&(q.preventDefault(),le.handleActived(w.args,q)):N?(X._keyCtx=w.row&&w.column&&v.length,clearTimeout(we),we=setTimeout(function(){X._keyCtx=!1},1e3)):R&&!z&&o&&g.isEnter&&(w.row||d.row||a&&(x.isCurrent||u)&&s)?L?d.row&&(l=d.args,le.clearEdit(q),h.selected)&&(0,_vue.nextTick)(function(){return le.handleSelected(l,q)}):w.row||d.row?(f=(w.row?w:d).args,F?g.enterToTab?le.moveTabSelected(f,F,q):le.moveSelected(f,y,!0,D,!1,q):g.enterToTab?le.moveTabSelected(f,F,q):le.moveSelected(f,y,!1,D,!0,q)):a&&(x.isCurrent||u)&&s&&(c=s[_])&&c.length&&(q.preventDefault(),t=c[0],l={$table:le,row:t,rowIndex:W.getRowIndex(t),$rowIndex:W.getVMRowIndex(t)},W.setTreeExpand(s,!0).then(function(){return W.scrollToRow(t)}).then(function(){return H.triggerCurrentRowEvent(q,l)})):U&&o&&g.isArrow?O||(w.row&&w.column?le.moveSelected(w.args,y,S,D,M,q):(S||M)&&(x.isCurrent||u)&&le.moveCurrentRow(S,M,q)):A&&o&&g.isTab?w.row||w.column?le.moveTabSelected(w.args,F,q):(d.row||d.column)&&le.moveTabSelected(d.args,F,q):o&&(0,_utils.isEnableConf)(i)&&(k||(a&&(x.isCurrent||u)&&s?E&&g.isArrow:E))?O||(m=g.delMethod,r=g.backMethod,g.isDel&&(w.row||w.column)?(m?m({row:w.row,rowIndex:W.getRowIndex(w.row),column:w.column,columnIndex:W.getColumnIndex(w.column),$table:le}):(0,_util.setCellValue)(w.row,w.column,null),E?r?r({row:w.row,rowIndex:W.getRowIndex(w.row),column:w.column,columnIndex:W.getColumnIndex(w.column),$table:le}):le.handleActived(w.args,q):k&&W.updateFooter()):E&&g.isArrow&&a&&(x.isCurrent||u)&&s&&(n=_xeUtils.default.findTree(X.afterFullData,function(e){return e===s},{children:_}).parent)&&(q.preventDefault(),l={$table:le,row:n,rowIndex:W.getRowIndex(n),$rowIndex:W.getVMRowIndex(n)},W.setTreeExpand(n,!1).then(function(){return W.scrollToRow(n)}).then(function(){return H.triggerCurrentRowEvent(q,l)}))):o&&(0,_utils.isEnableConf)(i)&&g.isEdit&&!L&&!V&&(T||48<=b&&b<=57||65<=b&&b<=90||96<=b&&b<=111||186<=b&&b<=192||219<=b&&b<=222)&&(C=g.editMethod,w.column)&&w.row&&(0,_utils.isEnableConf)(w.column.editRender)&&((I=p.beforeEditMethod||p.activeMethod)&&!I(__assign(__assign({},w.args),{$table:le,$grid:B}))||(C?C({row:w.row,rowIndex:W.getRowIndex(w.row),column:w.column,columnIndex:W.getColumnIndex(w.column),$table:le,$grid:B}):((0,_util.setCellValue)(w.row,w.column,null),le.handleActived(w.args,q)))),W.dispatchEvent("keydown",{},q)})}function ve(e){var t=P.keyboardConfig,l=P.mouseConfig,n=K.editStore,r=K.filterStore,o=X.isActivated,a=Q.value,i=ee.value,n=n.actived;o&&!r.visible&&(n.row||n.column||t&&i.isClip&&l&&a.area&&le.handlePasteCellAreaEvent&&le.handlePasteCellAreaEvent(e),W.dispatchEvent("paste",{},e))}function ge(e){var t=P.keyboardConfig,l=P.mouseConfig,n=K.editStore,r=K.filterStore,o=X.isActivated,a=Q.value,i=ee.value,n=n.actived;o&&!r.visible&&(n.row||n.column||t&&i.isClip&&l&&a.area&&le.handleCopyCellAreaEvent&&le.handleCopyCellAreaEvent(e),W.dispatchEvent("copy",{},e))}function he(e){var t=P.keyboardConfig,l=P.mouseConfig,n=K.editStore,r=K.filterStore,o=X.isActivated,a=Q.value,i=ee.value,n=n.actived;o&&!r.visible&&(n.row||n.column||t&&i.isClip&&l&&a.area&&le.handleCutCellAreaEvent&&le.handleCutCellAreaEvent(e),W.dispatchEvent("cut",{},e))}function pe(){le.closeMenu&&le.closeMenu(),W.updateCellAreas(),W.recalculate(!0)}function _e(e){var t=q.value;clearTimeout(X.tooltipTimeout),e?W.closeTooltip():t&&t.setActived(!0)}function me(e,t,l,n,r){r.cell=t;var t=K.tooltipStore,o=s.value,a=r.column,i=r.row,u=o.showAll,r=(o=o.contentMethod)?o(r):null,c=(o=o&&!_xeUtils.default.eqNull(r))?r:_xeUtils.default.toString("html"===a.type?l.innerText:l.textContent).trim(),d=l.scrollWidth>l.clientWidth;c&&(u||o||d)&&(Object.assign(t,{row:i,column:a,visible:!0,currOpts:null}),(0,_vue.nextTick)(function(){var e=q.value;e&&e.open(!d&&n||l,(0,_utils.formatText)(c))})),(0,_vue.nextTick)()}function xe(e){var t=P.showHeader,l=P.showFooter,n=K.tableData,r=K.tableColumn,o=K.tableGroupColumn,a=K.columnStore,i=K.footerTableData,u="left"===e,a=u?a.leftList:a.rightList;return(0,_vue.h)("div",{ref:u?Oe:Ae,class:"vxe-table--fixed-".concat(e,"-wrapper")},[t?(0,_vue.h)(_header.default,{ref:u?ke:Fe,fixedType:e,tableData:n,tableColumn:r,tableGroupColumn:o,fixedColumn:a}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:u?Ie:d,fixedType:e,tableData:n,tableColumn:r,fixedColumn:a}),l?(0,_vue.h)(_footer.default,{ref:u?Le:Ue,footerTableData:i,tableColumn:r,fixedColumn:a,fixedType:e}):(0,_vue.createCommentVNode)()])}var f,we,V=e.slots,be=e.emit,Ce=_vXETable.VXETable.tooltip,Ee=_xeUtils.default.uniqueId(),Re=(0,_size.useSize)(P),Te=(0,_vue.getCurrentInstance)(),K=(0,_vue.reactive)({staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,lastScrollTime:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,selectCheckboxMaps:{},currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],expandColumn:null,treeNodeColumn:null,hasFixedColumn:!1,rowExpandedMaps:{},rowExpandLazyLoadedMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{},treeIndeterminateMaps:{},mergeList:[],mergeFooterList:[],upDataFlag:0,reColumnFlag:0,pendingRowMaps:{},pendingRowList:[],initStore:{filter:!1,import:!1,export:!1},filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],scaleList:[],scaleMinList:[],autoList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},insertMaps:{},removeMaps:{}},tooltipStore:{row:null,column:null,content:null,visible:!1,currOpts:null},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isFooter:!1},scrollVMLoading:!1,_isResize:!1}),X={tZindex:0,elemStore:{},scrollXStore:{offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},scrollYStore:{rowHeight:0,offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,customHeight:0,customMinHeight:0,customMaxHeight:0,hoverRow:null,lastScrollLeft:0,lastScrollTop:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},treeIndeterminateRowMaps:{},tableFullData:[],afterFullData:[],afterTreeFullData:[],afterFullRowMaps:{},tableFullTreeData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},sourceDataRowIdData:{},fullDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},inited:!1,tooltipTimeout:null,initStatus:!1,isActivated:!1},W={},H={},z=(0,_vue.ref)(),q=(0,_vue.ref)(),ye=(0,_vue.ref)(),Se=(0,_vue.ref)(),De=(0,_vue.ref)(),Me=(0,_vue.ref)(),$=(0,_vue.ref)(),j=(0,_vue.ref)(),Y=(0,_vue.ref)(),ke=(0,_vue.ref)(),Ie=(0,_vue.ref)(),Le=(0,_vue.ref)(),Fe=(0,_vue.ref)(),d=(0,_vue.ref)(),Ue=(0,_vue.ref)(),Oe=(0,_vue.ref)(),Ae=(0,_vue.ref)(),Ne=(0,_vue.ref)(),Ve=(0,_vue.ref)(),B=(0,_vue.inject)("$xegrid",null),ze=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.validConfig,P.validConfig)}),qe=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.scrollX,P.scrollX)}),x=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.scrollY,P.scrollY)}),He=(0,_vue.computed)(function(){return{default:48,medium:44,small:40,mini:36}}),G=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.columnConfig,P.columnConfig)}),Z=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.rowConfig,P.rowConfig)}),$e=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.resizeConfig,P.resizeConfig)}),Pe=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.resizableConfig,P.resizableConfig)}),Ke=(0,_vue.computed)(function(){return Object.assign({startIndex:0},_conf.default.table.seqConfig,P.seqConfig)}),E=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.radioConfig,P.radioConfig)}),R=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.checkboxConfig,P.checkboxConfig)}),s=((0,_vue.ref)(),(0,_vue.computed)(function(){return Object.assign({},_conf.default.tooltip,_conf.default.table.tooltipConfig,P.tooltipConfig)})),Xe=(0,_vue.computed)(function(){var e=K.tooltipStore,t=s.value;return __assign(__assign({},t),e.currOpts)}),We=(0,_vue.computed)(function(){var e=s.value;return Object.assign({isArrow:!1},e)}),J=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.editConfig,P.editConfig)}),T=(0,_vue.computed)(function(){return Object.assign({orders:["asc","desc",null]},_conf.default.table.sortConfig,P.sortConfig)}),je=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.filterConfig,P.filterConfig)}),Q=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.mouseConfig,P.mouseConfig)}),Ye=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.areaConfig,P.areaConfig)}),ee=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.keyboardConfig,P.keyboardConfig)}),Be=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.clipConfig,P.clipConfig)}),Ge=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.fnrConfig,P.fnrConfig)}),r=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.menuConfig,P.menuConfig)}),Ze=(0,_vue.computed)(function(){var e=r.value.header;return e&&e.options?e.options:[]}),Je=(0,_vue.computed)(function(){var e=r.value.body;return e&&e.options?e.options:[]}),Qe=(0,_vue.computed)(function(){var e=r.value.footer;return e&&e.options?e.options:[]}),et=(0,_vue.computed)(function(){var e=r.value,t=Ze.value,l=Je.value,n=Qe.value;return!!(P.menuConfig&&(0,_utils.isEnableConf)(e)&&(t.length||l.length||n.length))}),tt=(0,_vue.computed)(function(){var e=K.ctxMenuStore,t=[];return e.list.forEach(function(e){e.forEach(function(e){t.push(e)})}),t}),lt=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.exportConfig,P.exportConfig)}),nt=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.importConfig,P.importConfig)}),rt=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.printConfig,P.printConfig)}),y=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.expandConfig,P.expandConfig)}),te=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.treeConfig,P.treeConfig)}),ot=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.emptyRender,P.emptyRender)}),at=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.loadingConfig,P.loadingConfig)}),it=(0,_vue.computed)(function(){return P.border?Math.max(2,Math.ceil(K.scrollbarWidth/K.tableColumn.length)):1}),v=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.customConfig,P.customConfig)}),ut=(0,_vue.computed)(function(){var e=X.tableFullColumn,t=0;return e.forEach(function(e){e.fixed&&t++}),t}),ct=(0,_vue.computed)(function(){var e=ut.value,t=G.value.maxFixedSize;return!!t&&t<=e}),dt=(0,_vue.computed)(function(){var e=P.border;return!0===e?"full":e||"default"}),st=(0,_vue.computed)(function(){P.treeConfig;var e=K.tableData,t=X.tableFullData,l=R.value,n=l.strict,r=l.checkMethod;return!!n&&(!e.length&&!t.length||!!r&&t.every(function(e){return!r({row:e})}))}),ft={refElem:z,refTooltip:q,refValidTooltip:Se,refTableFilter:De,refTableMenu:Me,refTableHeader:$,refTableBody:j,refTableFooter:Y,refTableLeftHeader:ke,refTableLeftBody:Ie,refTableLeftFooter:Le,refTableRightHeader:Fe,refTableRightBody:d,refTableRightFooter:Ue,refLeftContainer:Oe,refRightContainer:Ae,refCellResizeBar:Ne},vt={computeSize:Re,computeValidOpts:ze,computeSXOpts:qe,computeSYOpts:x,computeColumnOpts:G,computeRowOpts:Z,computeResizeleOpts:$e,computeResizableOpts:Pe,computeSeqOpts:Ke,computeRadioOpts:E,computeCheckboxOpts:R,computeTooltipOpts:s,computeEditOpts:J,computeSortOpts:T,computeFilterOpts:je,computeMouseOpts:Q,computeAreaOpts:Ye,computeKeyboardOpts:ee,computeClipOpts:Be,computeFNROpts:Ge,computeHeaderMenu:Ze,computeBodyMenu:Je,computeFooterMenu:Qe,computeIsMenu:et,computeMenuOpts:r,computeExportOpts:lt,computeImportOpts:nt,computePrintOpts:rt,computeExpandOpts:y,computeTreeOpts:te,computeEmptyOpts:ot,computeLoadingOpts:at,computeCustomOpts:v,computeFixedColumnSize:ut,computeIsMaxFixedColumn:ct,computeIsAllCheckboxDisabled:st},le={xID:Ee,props:P,context:e,instance:Te,reactData:K,internalData:X,getRefMaps:function(){return ft},getComputeMaps:function(){return vt},xegrid:B},g=function(e){var t=_conf.default.version,e=_xeUtils.default.toStringJSON(localStorage.getItem(e)||"");return e&&e._v===t?e:{_v:t}},gt=function(e){var l=X.fullAllDataRowIdData,n={};return _xeUtils.default.each(e,function(e,t){l[t]&&(n[t]=e)}),n},ht=function(e){var l=X.fullDataRowIdData,n=[];return _xeUtils.default.each(e,function(e,t){l[t]&&-1===le.findRowIndexOf(n,l[t].row)&&n.push(l[t].row)}),n},pt=function(){var e=X.visibleColumn,t=j.value,t=t?t.$el:null;if(t){for(var l=t.scrollLeft,n=l+t.clientWidth,r=-1,o=0,a=0,i=0,u=e.length;i<u&&(o+=e[i].renderWidth,!(0<=(r=-1===r&&l<o?i:r)&&(a++,n<o)));i++);return{toVisibleIndex:Math.max(0,r),visibleSize:Math.max(8,a)}}return{toVisibleIndex:0,visibleSize:8}},_t=function(){var e,t,l=$.value,n=j.value,n=n?n.$el:null,r=Re.value,o=He.value;return n?(l=l?l.$el:null,e=void(t=0),{rowHeight:t=(t=(e=!(e=n.querySelector("tr"))&&l?l.querySelector("tr"):e)?e.clientHeight:t)||o[r||"default"],visibleSize:Math.max(8,Math.ceil(n.clientHeight/t)+2)}):{rowHeight:0,visibleSize:8}},mt=function(e,t,l){for(var n=0,r=e.length;n<r;n++){var o=e[n],a=t.startIndex,i=t.endIndex,u=o[l],o=u+o[l+"span"];u<a&&a<o&&(t.startIndex=u),u<i&&i<o&&(t.endIndex=o),t.startIndex===a&&t.endIndex===i||(n=-1)}},xt=function(e){var t,l=K.parentHeight,e=P[e],n=0;return n=e?"auto"===e?l:(t=le.getExcludeHeight(),n=(0,_dom.isScale)(e)?Math.floor((_xeUtils.default.toInteger(e)||1)/100*l):_xeUtils.default.toNumber(e),Math.max(40,n-t)):n},w=function(){var g=P.border,h=P.showFooter,p=P.showOverflow,_=P.showHeaderOverflow,m=P.showFooterOverflow,e=P.mouseConfig,x=P.spanMethod,w=P.footerSpanMethod,b=P.keyboardConfig,C=K.isGroup,t=K.currentRow,E=K.tableColumn,R=K.scrollXLoad,T=K.scrollYLoad,y=K.scrollbarWidth,S=K.scrollbarHeight,l=K.columnStore,n=K.editStore,D=K.mergeList,M=K.mergeFooterList,k=K.isAllOverflow,I=X.visibleColumn,L=X.fullColumnIdData,F=X.tableHeight,U=X.tableWidth,O=X.headerHeight,A=X.footerHeight,N=X.elemStore,V=X.customHeight,z=X.customMinHeight,q=X.customMaxHeight,r=Ve.value,H=it.value,o=Q.value,$=ee.value,a=N["main-body-wrapper"],a=a?a.value:null;return r&&(r.style.top="".concat(O,"px"),r.style.height=a?"".concat(a.offsetHeight-S,"px"):""),0<V&&h&&(V+=S),["main","left","right"].forEach(function(c,e){var d,s=0<e?c:"",f="left"===s,v=[];s&&(v=f?l.leftList:l.rightList,d=(f?Oe:Ae).value),["header","body","footer"].forEach(function(o){var e,t,l,n,r=N["".concat(c,"-").concat(o,"-wrapper")],r=r?r.value:null,a=N["".concat(c,"-").concat(o,"-table")],a=a?a.value:null,i=("header"===o?(l=U,n=E,C?n=I:s&&(R||_)&&(n=v),l=n.reduce(function(e,t){return e+t.renderWidth},0),a&&(a.style.width=l?"".concat(l+y,"px"):""),(e=(e=N["".concat(c,"-").concat(o,"-repair")])?e.value:null)&&(e.style.width="".concat(U,"px")),e=(e=N["".concat(c,"-").concat(o,"-list")])?e.value:null,C&&e&&_xeUtils.default.arrayEach(e.querySelectorAll(".col--group"),function(e){var t,l,n,r=W.getColumnNode(e);r&&(r=(t=r.item).showHeaderOverflow,r=_xeUtils.default.isBoolean(r)?r:_,n=l=0,(r="title"===r||(!0===r||"tooltip"===r)||"ellipsis"===r)&&_xeUtils.default.eachTree(t.children,function(e){e.children&&t.children.length||n++,l+=e.renderWidth},{children:"children"}),e.style.width=r?"".concat(l-n-(g?2:0),"px"):"")})):"body"===o?(e=(e=N["".concat(c,"-").concat(o,"-emptyBlock")])?e.value:null,(0,_dom.isNodeElement)(r)&&(i=0,t=z-O-A,q&&(i=q-O-A,s&&(i-=h?0:S),i=Math.max(t,i),r.style.maxHeight="".concat(i,"px")),V?(u=V-O-A,s&&(u-=h?0:S),i&&(u=Math.min(i,u)),r.style.height="".concat(Math.max(t,u),"px")):r.style.height="",r.style.minHeight="".concat(t,"px")),d&&((0,_dom.isNodeElement)(r)&&(r.style.top="".concat(O,"px")),d.style.height="".concat((0<V?V-O-A:F)+O+A-S*(h?2:1),"px"),d.style.width="".concat(v.reduce(function(e,t){return e+t.renderWidth},f?0:y),"px")),l=U,n=E,l=(n=s?K.expandColumn||!(T||p&&k)||D.length||x||b&&$.isMerge?I:v:n).reduce(function(e,t){return e+t.renderWidth},0),a&&(a.style.width=l?"".concat(l,"px"):"",a.style.paddingRight=y&&s&&(_dom.browse["-moz"]||_dom.browse.safari)?"".concat(y,"px"):""),e&&(e.style.width=l?"".concat(l,"px"):"")):"footer"===o&&(l=U,n=E,l=(n=s?K.expandColumn||!R&&!m||M.length&&w?I:v:n).reduce(function(e,t){return e+t.renderWidth},0),(0,_dom.isNodeElement)(r)&&(d&&(r.style.top="".concat(0<V?V-A:F+O,"px")),r.style.marginTop="".concat(-Math.max(1,S),"px")),a)&&(a.style.width=l?"".concat(l+y,"px"):""),N["".concat(c,"-").concat(o,"-colgroup")]),u=i?i.value:null;u&&_xeUtils.default.arrayEach(u.children,function(e){var a,t,l,i,n,r=e.getAttribute("name");"col_gutter"===r&&(e.style.width="".concat(y,"px")),L[r]&&(r=(a=L[r].column).showHeaderOverflow,n=a.showFooterOverflow,t=a.showOverflow,l=void 0,e.style.width="".concat(a.renderWidth,"px"),e="ellipsis"===(l="header"===o?_xeUtils.default.isUndefined(r)||_xeUtils.default.isNull(r)?_:r:"footer"===o?_xeUtils.default.isUndefined(n)||_xeUtils.default.isNull(n)?m:n:_xeUtils.default.isUndefined(t)||_xeUtils.default.isNull(t)?p:t),i="title"===l||(!0===l||"tooltip"===l)||e,n=(r=N["".concat(c,"-").concat(o,"-list")])?r.value:null,T&&!i&&(i=!0),n)&&_xeUtils.default.arrayEach(n.querySelectorAll(".".concat(a.id)),function(e){var t=parseInt(e.getAttribute("colspan")||1),e=e.querySelector(".vxe-cell"),l=a.renderWidth;if(e){if(1<t)for(var n=W.getColumnIndex(a),r=1;r<t;r++){var o=W.getColumns(n+r);o&&(l+=o.renderWidth)}e.style.width=i?"".concat(l-H*t,"px"):""}})})})}),t&&W.setCurrentRow(t),e&&o.selected&&n.selected.row&&n.selected.column&&le.addCellSelectedClass(),(0,_vue.nextTick)()},wt=function(e,t){var l=E.value.checkMethod;return e&&(t||!l||l({row:e}))&&(K.selectRadioRow=e,t=e,E.value.reserve)&&(X.radioReserveRow=t),(0,_vue.nextTick)()},S=function(e,t,l){return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(function(e){return H.handleSelectRow({row:e},!!t,l)}),(0,_vue.nextTick)()},bt=function(t,l){var n=P.treeConfig,r=K.selectCheckboxMaps,e=X.afterFullData,o=X.afterFullRowMaps,a=X.checkboxReserveRowMap,i=te.value,i=i.children||i.childrenField,u=R.value,c=u.checkField,d=u.reserve,s=u.checkStrictly,f=u.checkMethod,v=u.indeterminateField||u.halfField,g={};return n||_xeUtils.default.each(r,function(e,t){o[t]||(g[t]=e)}),s?K.isAllSelected=t:(c?(u=function(e){!l&&f&&!f({row:e})||(t&&(g[(0,_util.getRowid)(le,e)]=e),_xeUtils.default.set(e,c,t)),n&&v&&_xeUtils.default.set(e,v,!1)},n?_xeUtils.default.eachTree(e,u,{children:i}):e.forEach(u)):n?t?_xeUtils.default.eachTree(e,function(e){!l&&f&&!f({row:e})||(g[(0,_util.getRowid)(le,e)]=e)},{children:i}):!l&&f&&_xeUtils.default.eachTree(e,function(e){var t=(0,_util.getRowid)(le,e);!f({row:e})&&r[t]&&(g[t]=e)},{children:i}):t?!l&&f?e.forEach(function(e){var t=(0,_util.getRowid)(le,e);(r[t]||f({row:e}))&&(g[t]=e)}):e.forEach(function(e){g[(0,_util.getRowid)(le,e)]=e}):!l&&f&&e.forEach(function(e){var t=(0,_util.getRowid)(le,e);!f({row:e})&&r[t]&&(g[t]=e)}),d&&(t?_xeUtils.default.each(g,function(e,t){a[t]=e}):e.forEach(function(e){return C(e,!1)})),K.selectCheckboxMaps=c?{}:g),K.treeIndeterminateMaps={},X.treeIndeterminateRowMaps={},H.checkSelectionStatus(),(0,_vue.nextTick)()},Ct=function(o){var e=te.value,t=R.value,a=e.transform,i=e.loadMethod,u=t.checkStrictly;return new Promise(function(e){var t,l,n,r;i?(t=K.treeExpandLazyLoadedMaps,l=X.fullAllDataRowIdData,n=(0,_util.getRowid)(le,o),r=l[n],t[n]=o,i({$table:le,row:o}).then(function(e){if(r.treeLoaded=!0,t[n]&&delete t[n],e=_xeUtils.default.isArray(e)?e:[])return W.loadTreeChildren(o,e).then(function(e){var t=K.treeExpandedMaps;return e.length&&!t[n]&&(t[n]=o),!u&&W.isCheckedByCheckboxRow(o)&&S(e,!0),(0,_vue.nextTick)().then(function(){if(a)return H.handleTableData()})})}).catch(function(){var e=K.treeExpandLazyLoadedMaps;r.treeLoaded=!1,e[n]&&delete e[n]}).finally(function(){(0,_vue.nextTick)().then(function(){return W.recalculate()}).then(function(){return e()})})):e()})},Et=function(e,t){var l,n=X.treeExpandedReserveRowMap;te.value.reserve&&(l=(0,_util.getRowid)(le,e),t?n[l]=e:n[l]&&delete n[l])},Rt=function(){var e=K.scrollXLoad,t=X.visibleColumn,l=X.scrollXStore,n=X.fullColumnIdData,e=e?t.slice(l.startIndex,l.endIndex):t.slice(0);e.forEach(function(e,t){e=e.id,e=n[e];e&&(e.$index=t)}),K.tableColumn=e},Tt=function(e){var t=[];return e.forEach(function(e){t.push.apply(t,e.children&&e.children.length?Tt(e.children):[e])}),t},yt=_xeUtils.default.debounce(function(e){oe(e)},20,{leading:!1,trailing:!0}),W={dispatchEvent:function(e,t,l){be(e,Object.assign({$table:le,$grid:B,$event:l},t))},clearAll:function(){return(0,_util.clearTableAllStatus)(le)},syncData:function(){return(0,_log.warnLog)("vxe.error.delFunc",["syncData","getData"]),(0,_vue.nextTick)().then(function(){return K.tableData=[],be("update:data",X.tableFullData),(0,_vue.nextTick)()})},updateData:function(){var e=K.scrollXLoad,t=K.scrollYLoad;return H.handleTableData(!0).then(function(){if(W.updateFooter(),e||t)return e&&H.updateScrollXSpace(),t&&H.updateScrollYSpace(),W.refreshScroll()}).then(function(){return W.updateCellAreas(),W.recalculate(!0)}).then(function(){setTimeout(function(){return le.recalculate()},50)})},loadData:function(e){var t=X.inited,l=X.initStatus;return U(e).then(function(){return X.inited=!0,X.initStatus=!0,l||O(),t||A(),W.recalculate()})},reloadData:function(e){var t=X.inited;return W.clearAll().then(function(){return X.inited=!0,X.initStatus=!0,U(e)}).then(function(){return O(),t||A(),W.recalculate()})},reloadRow:function(e,t,l){var n=P.keepSource,r=K.tableData,o=X.tableSourceData;return n?((n=o[W.getRowIndex(e)])&&e&&(l?(o=_xeUtils.default.get(t||e,l),_xeUtils.default.set(e,l,o),_xeUtils.default.set(n,l,o)):(l=_xeUtils.default.clone(__assign({},t),!0),_xeUtils.default.destructuring(n,Object.assign(e,l)))),K.tableData=r.slice(0)):"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)()},loadTreeChildren:function(n,e){var r=P.keepSource,o=X.tableSourceData,i=X.fullDataRowIdData,u=X.fullAllDataRowIdData,a=X.sourceDataRowIdData,t=te.value,c=t.transform,d=t.mapChildrenField,s=t.children||t.childrenField,t=u[(0,_util.getRowid)(le,n)],f=t?t.level:0;return W.createData(e).then(function(e){var t,l;return r&&(t=(0,_util.getRowid)(le,n),(l=_xeUtils.default.findTree(o,function(e){return t===(0,_util.getRowid)(le,e)},{children:s}))&&(l.item[s]=_xeUtils.default.clone(e,!0)),e.forEach(function(e){var t=(0,_util.getRowid)(le,e);a[t]=_xeUtils.default.clone(e,!0)})),_xeUtils.default.eachTree(e,function(e,t,l,n,r,o){var a=(0,_util.getRowid)(le,e),e={row:e,rowid:a,seq:-1,index:t,_index:-1,$index:-1,items:l,parent:r,level:f+o.length};i[a]=e,u[a]=e},{children:s}),n[s]=e,c&&(n[d]=e),k(),e})},loadColumn:function(e){e=_xeUtils.default.mapTree(e,function(e){return(0,_vue.reactive)(_cell.default.createColumn(le,e))});return o(e)},reloadColumn:function(e){return W.clearAll().then(function(){return W.loadColumn(e)})},getRowNode:function(e){if(e){var t=X.fullAllDataRowIdData,e=e.getAttribute("rowid");if(e){t=t[e];if(t)return{rowid:t.rowid,item:t.row,index:t.index,items:t.items,parent:t.parent}}}return null},getColumnNode:function(e){if(e){var t=X.fullColumnIdData,e=e.getAttribute("colid");if(e){t=t[e];if(t)return{colid:t.colid,item:t.column,index:t.index,items:t.items,parent:t.parent}}}return null},getRowSeq:ae("seq"),getRowIndex:ae("index"),getVTRowIndex:ae("_index"),getVMRowIndex:ae("$index"),getColumnIndex:ie("index"),getVTColumnIndex:ie("_index"),getVMColumnIndex:ie("$index"),createData:function(e){return(0,_vue.nextTick)().then(function(){return(0,_vue.reactive)(H.defineField(e))})},createRow:function(e){var t=_xeUtils.default.isArray(e);return W.createData(e=t?e:[e||{}]).then(function(e){return t?e:e[0]})},revertData:function(e,l){var t=P.keepSource,n=X.tableSourceData,r=X.sourceDataRowIdData;return t?((t=e)?_xeUtils.default.isArray(e)||(t=[e]):t=_xeUtils.default.toArray(le.getUpdateRecords()),t.length&&t.forEach(function(e){var t;W.isInsertByRow(e)||(t=(0,_util.getRowid)(le,e),(t=r[t])&&e&&(l?_xeUtils.default.set(e,l,_xeUtils.default.clone(_xeUtils.default.get(t,l),!0)):_xeUtils.default.destructuring(e,_xeUtils.default.clone(t,!0))))}),e?(0,_vue.nextTick)():W.reloadData(n)):("development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)())},clearData:function(e,t){var l=X.tableFullData,n=X.visibleColumn;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=l,t?e.forEach(function(e){return _xeUtils.default.set(e,t,null)}):e.forEach(function(t){n.forEach(function(e){e.field&&(0,_util.setCellValue)(t,e,null)})}),(0,_vue.nextTick)()},isInsertByRow:function(e){var t=K.editStore,e=(0,_util.getRowid)(le,e);return t.insertMaps[e]},removeInsertRow:function(){return K.editStore.insertMaps={},le.remove(le.getInsertRecords())},isUpdateByRow:function(e,t){var l=P.keepSource,n=X.tableFullColumn,r=X.fullDataRowIdData,o=X.sourceDataRowIdData;if(l){l=(0,_util.getRowid)(le,e);if(!r[l])return!1;var a=o[l];if(a){if(1<arguments.length)return!p(a,e,t);for(var i=0,u=n.length;i<u;i++){var c=n[i].field;if(c&&!p(a,e,c))return!0}}}return!1},getColumns:function(e){var t=X.visibleColumn;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getColumnById:function(e){var t=X.fullColumnIdData;return t[e]?t[e].column:null},getColumnByField:function(e){var t=X.fullColumnFieldData;return t[e]?t[e].column:null},getTableColumn:function(){return{collectColumn:X.collectColumn.slice(0),fullColumn:X.tableFullColumn.slice(0),visibleColumn:X.visibleColumn.slice(0),tableColumn:K.tableColumn.slice(0)}},getData:function(e){var t=P.data||X.tableSynchData;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getCheckboxRecords:function(l){var e=P.treeConfig,t=X.tableFullData,n=X.afterFullData,r=X.afterTreeFullData,o=X.tableFullTreeData,a=X.fullDataRowIdData,i=X.afterFullRowMaps,u=te.value,c=R.value,d=u.transform,s=u.mapChildrenField,f=c.checkField,c=u.children||u.childrenField,v=[],u=l?d?o:t:d?r:n;return f?v=e?_xeUtils.default.filterTree(u,function(e){return _xeUtils.default.get(e,f)},{children:d?s:c}):u.filter(function(e){return _xeUtils.default.get(e,f)}):(o=K.selectCheckboxMaps,_xeUtils.default.each(o,function(e,t){(l?a:i)[t]&&v.push(e)})),v},getParentRow:function(e){var t=P.treeConfig,l=X.fullDataRowIdData;if(e&&t){t=void 0;if(t=_xeUtils.default.isString(e)?e:(0,_util.getRowid)(le,e))return l[t]?l[t].parent:null}return null},getRowById:function(e){var t=X.fullDataRowIdData,e=_xeUtils.default.eqNull(e)?"":encodeURIComponent(e);return t[e]?t[e].row:null},getRowid:function(e){return(0,_util.getRowid)(le,e)},getTableData:function(){var e=K.tableData,t=K.footerTableData,l=X.tableFullData,n=X.afterFullData;return{fullData:l.slice(0),visibleData:n.slice(0),tableData:e.slice(0),footerData:t.slice(0)}},setColumnFixed:function(e,t){var e=(0,_util.handleFieldOrColumn)(le,e),e=(0,_util.getRootColumn)(le,e),l=ct.value;return e&&e.fixed!==t?!e.fixed&&l?(_vXETable.VXETable.modal&&_vXETable.VXETable.modal.message({status:"error",content:_conf.default.i18n("vxe.table.maxFixedCol")}),(0,_vue.nextTick)()):(_xeUtils.default.eachTree([e],function(e){e.fixed=t}),H.saveCustomFixed(),W.refreshColumn()):(0,_vue.nextTick)()},clearColumnFixed:function(e){e=(0,_util.handleFieldOrColumn)(le,e),e=(0,_util.getRootColumn)(le,e);return e&&e.fixed?(_xeUtils.default.eachTree([e],function(e){e.fixed=null}),H.saveCustomFixed(),W.refreshColumn()):(0,_vue.nextTick)()},hideColumn:function(e){e=(0,_util.handleFieldOrColumn)(le,e);return e&&e.visible?(e.visible=!1,H.handleCustom()):(0,_vue.nextTick)()},showColumn:function(e){e=(0,_util.handleFieldOrColumn)(le,e);return e&&!e.visible?(e.visible=!0,H.handleCustom()):(0,_vue.nextTick)()},setColumnWidth:function(e,t){var l,n,e=(0,_util.handleFieldOrColumn)(le,e);return e&&(n=l=_xeUtils.default.toInteger(t),(0,_dom.isScale)(t)&&(t=(t=(t=j.value)?t.$el:null)?t.clientWidth-1:0,n=Math.floor(l*t)),e.renderWidth=n),(0,_vue.nextTick)()},getColumnWidth:function(e){e=(0,_util.handleFieldOrColumn)(le,e);return e?e.renderWidth:0},resetColumn:function(e){var t=X.collectColumn,l=v.value.checkMethod,n=Object.assign({visible:!0,resizable:!0===e,fixed:!0===e},e);return _xeUtils.default.eachTree(t,function(e){n.resizable&&(e.resizeWidth=0),n.fixed&&(e.fixed=e.defaultFixed),l&&!l({column:e})||(e.visible=e.defaultVisible)}),n.resizable&&H.saveCustomResizable(!0),n.fixed&&H.saveCustomFixed(),H.handleCustom()},refreshColumn:function(){return ne().then(function(){return W.refreshScroll()}).then(function(){return W.recalculate()})},refreshScroll:function(){var t=X.lastScrollLeft,l=X.lastScrollTop,e=j.value,n=Y.value,r=Ie.value,o=d.value,a=e?e.$el:null,i=r?r.$el:null,u=o?o.$el:null,c=n?n.$el:null;return new Promise(function(e){if(t||l)return(0,_util.restoreScrollLocation)(le,t,l).then().then(function(){setTimeout(e,30)});(0,_dom.setScrollTop)(a,l),(0,_dom.setScrollTop)(i,l),(0,_dom.setScrollTop)(u,l),(0,_dom.setScrollLeft)(c,t),setTimeout(e,30)})},recalculate:function(e){return n(),!0===e?F().then(function(){return n(),F()}):F()},openTooltip:function(e,t){var l=ye.value;return l?l.open(e,t):(0,_vue.nextTick)()},closeTooltip:function(){var e=K.tooltipStore,t=q.value,l=ye.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1}),t)&&t.close(),l&&l.close(),(0,_vue.nextTick)()},isAllCheckboxChecked:function(){return K.isAllSelected},isAllCheckboxIndeterminate:function(){return!K.isAllSelected&&K.isIndeterminate},getCheckboxIndeterminateRecords:function(e){var l,n,t=P.treeConfig,r=X.fullDataRowIdData,o=K.treeIndeterminateMaps;return t?(l=[],n=[],_xeUtils.default.each(o,function(e,t){e&&(l.push(e),r[t])&&n.push(e)}),e?l:n):[]},setCheckboxRow:function(e,t){return S(e,t,!0)},isCheckedByCheckboxRow:function(e){var t=K.selectCheckboxMaps,l=R.value.checkField;return l?_xeUtils.default.get(e,l):!!t[(0,_util.getRowid)(le,e)]},isIndeterminateByCheckboxRow:function(e){return!!K.treeIndeterminateMaps[(0,_util.getRowid)(le,e)]&&!W.isCheckedByCheckboxRow(e)},toggleCheckboxRow:function(e){var t=K.selectCheckboxMaps,l=R.value.checkField,l=l?!_xeUtils.default.get(e,l):!t[(0,_util.getRowid)(le,e)];return H.handleSelectRow({row:e},l,!0),(0,_vue.nextTick)()},setAllCheckboxRow:function(e){return bt(e,!0)},getRadioReserveRecord:function(e){var t=P.treeConfig,l=X.fullDataRowIdData,n=X.radioReserveRow,r=X.afterFullData,o=E.value,a=te.value,a=a.children||a.childrenField;if(o.reserve&&n){var i=(0,_util.getRowid)(le,n);if(e){if(!l[i])return n}else{var u=(0,_util.getRowkey)(le);if(t){if(_xeUtils.default.findTree(r,function(e){return i===_xeUtils.default.get(e,u)},{children:a}))return n}else if(!r.some(function(e){return i===_xeUtils.default.get(e,u)}))return n}}return null},clearRadioReserve:function(){return(X.radioReserveRow=null,_vue.nextTick)()},getCheckboxReserveRecords:function(l){var n,e=P.treeConfig,t=X.afterFullData,r=X.fullDataRowIdData,o=X.checkboxReserveRowMap,a=R.value,i=te.value,i=i.children||i.childrenField,u=[];return a.reserve&&(n={},e?_xeUtils.default.eachTree(t,function(e){n[(0,_util.getRowid)(le,e)]=1},{children:i}):t.forEach(function(e){n[(0,_util.getRowid)(le,e)]=1}),_xeUtils.default.each(o,function(e,t){e&&(l?r[t]||u.push(e):n[t]||u.push(e))})),u},clearCheckboxReserve:function(){return X.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow:function(){return H.triggerCheckAllEvent(null,!K.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow:function(){var t=P.treeConfig,e=X.tableFullData,l=te.value,l=l.children||l.childrenField,n=R.value,r=n.checkField,o=n.reserve,a=n.indeterminateField||n.halfField;return r&&(n=function(e){t&&a&&_xeUtils.default.set(e,a,!1),_xeUtils.default.set(e,r,!1)},t?_xeUtils.default.eachTree(e,n,{children:l}):e.forEach(n)),o&&e.forEach(function(e){return C(e,!1)}),K.isAllSelected=!1,K.isIndeterminate=!1,K.selectCheckboxMaps={},K.treeIndeterminateMaps={},(0,_vue.nextTick)()},setCurrentRow:function(e){var t=Z.value,l=z.value;return W.clearCurrentRow(),K.currentRow=e,(t.isCurrent||P.highlightCurrentRow)&&l&&_xeUtils.default.arrayEach(l.querySelectorAll('[rowid="'.concat((0,_util.getRowid)(le,e),'"]')),function(e){return(0,_dom.addClass)(e,"row--current")}),(0,_vue.nextTick)()},isCheckedByRadioRow:function(e){return le.eqRow(K.selectRadioRow,e)},setRadioRow:function(e){return wt(e,!0)},clearCurrentRow:function(){var e=z.value;return K.currentRow=null,X.hoverRow=null,e&&_xeUtils.default.arrayEach(e.querySelectorAll(".row--current"),function(e){return(0,_dom.removeClass)(e,"row--current")}),(0,_vue.nextTick)()},clearRadioRow:function(){return(K.selectRadioRow=null,_vue.nextTick)()},getCurrentRecord:function(){return Z.value.isCurrent||P.highlightCurrentRow?K.currentRow:null},getRadioRecord:function(e){var t=X.fullDataRowIdData,l=X.afterFullRowMaps,n=K.selectRadioRow;if(n){var r=(0,_util.getRowid)(le,n);if(e){if(!t[r])return n}else if(l[r])return n}return null},getCurrentColumn:function(){return G.value.isCurrent||P.highlightCurrentColumn?K.currentColumn:null},setCurrentColumn:function(e){e=(0,_util.handleFieldOrColumn)(le,e);return e&&(W.clearCurrentColumn(),K.currentColumn=e),(0,_vue.nextTick)()},clearCurrentColumn:function(){return(K.currentColumn=null,_vue.nextTick)()},setPendingRow:function(e,t){var l=__assign({},K.pendingRowMaps),n=__spreadArray([],K.pendingRowList,!0);return e&&!_xeUtils.default.isArray(e)&&(e=[e]),t?e.forEach(function(e){var t=(0,_util.getRowid)(le,e);t&&!l[t]&&(n.push(e),l[t]=e)}):e.forEach(function(e){var t=(0,_util.getRowid)(le,e);t&&l[t]&&(-1<(e=le.findRowIndexOf(n,e))&&n.splice(e,1),delete l[t])}),K.pendingRowMaps=l,K.pendingRowList=n,(0,_vue.nextTick)()},togglePendingRow:function(e){var n=__assign({},K.pendingRowMaps),r=__spreadArray([],K.pendingRowList,!0);return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(function(e){var t,l=(0,_util.getRowid)(le,e);l&&(n[l]?(-1<(t=le.findRowIndexOf(r,e))&&r.splice(t,1),delete n[l]):(r.push(e),n[l]=e))}),K.pendingRowMaps=n,K.pendingRowList=r,(0,_vue.nextTick)()},hasPendingByRow:function(e){return!!K.pendingRowMaps[(0,_util.getRowid)(le,e)]},getPendingRecords:function(){return K.pendingRowList.slice(0)},clearPendingRow:function(){return K.pendingRowMaps={},K.pendingRowList=[],(0,_vue.nextTick)()},sort:function(e,t){var l=T.value,n=l.multiple,r=l.remote,o=l.orders;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:t}]),(e=_xeUtils.default.isArray(e)?e:[e]).length?(n||i(),(n?e:[e[0]]).forEach(function(e,t){var l=e.field,e=e.order,n=l;(n=_xeUtils.default.isString(l)?W.getColumnByField(l):n)&&n.sortable&&(-1===o.indexOf(e)&&(e=c(n)),n.order!==e&&(n.order=e),n.sortTime=Date.now()+t)}),r||H.handleTableData(!0),(0,_vue.nextTick)().then(function(){return W.updateCellAreas(),w()})):(0,_vue.nextTick)()},clearSort:function(e){var t=T.value;return e?(e=(0,_util.handleFieldOrColumn)(le,e))&&(e.order=null):i(),t.remote||H.handleTableData(!0),(0,_vue.nextTick)().then(w)},isSort:function(e){return e?!!(e=(0,_util.handleFieldOrColumn)(le,e))&&e.sortable&&!!e.order:0<W.getSortColumns().length},getSortColumns:function(){var e=T.value,t=e.multiple,e=e.chronological,n=[];return X.tableFullColumn.forEach(function(e){var t=e.field,l=e.order;e.sortable&&l&&n.push({column:e,field:t,property:t,order:l,sortTime:e.sortTime})}),t&&e&&1<n.length?_xeUtils.default.orderBy(n,"sortTime"):n},closeFilter:function(){var e=K.filterStore,t=e.column,l=e.visible;return Object.assign(e,{isAllSelected:!1,isIndeterminate:!1,options:[],visible:!1}),l&&le.dispatchEvent("filter-visible",{column:t,property:t.field,field:t.field,filterList:le.getCheckedFilters(),visible:!1},null),(0,_vue.nextTick)()},isActiveFilterByColumn:function(e){e=(0,_util.handleFieldOrColumn)(le,e);return e?e.filters&&e.filters.some(function(e){return e.checked}):0<le.getCheckedFilters().length},isFilter:function(e){return W.isActiveFilterByColumn(e)},isRowExpandLoaded:function(e){e=X.fullAllDataRowIdData[(0,_util.getRowid)(le,e)];return e&&!!e.expandLoaded},clearRowExpandLoaded:function(e){var t=K.rowExpandLazyLoadedMaps,l=X.fullAllDataRowIdData,n=y.value.lazy,e=(0,_util.getRowid)(le,e),l=l[e];return n&&l&&(l.expandLoaded=!1,delete t[e]),(0,_vue.nextTick)()},reloadRowExpand:function(e){var t=K.rowExpandLazyLoadedMaps,l=y.value.lazy,n=(0,_util.getRowid)(le,e);return l&&!t[n]&&W.clearRowExpandLoaded(e).then(function(){return m(e)}),(0,_vue.nextTick)()},reloadExpandContent:function(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadExpandContent","reloadRowExpand"]),W.reloadRowExpand(e)},toggleRowExpand:function(e){return W.setRowExpand(e,!W.isRowExpandByRow(e))},setAllRowExpand:function(e){var t=te.value,l=X.tableFullData,n=X.tableFullTreeData,t=t.children||t.childrenField,r=[];return P.treeConfig?_xeUtils.default.eachTree(n,function(e){r.push(e)},{children:t}):r=l,W.setRowExpand(r,e)},setRowExpand:function(e,t){var l=K.rowExpandedMaps,n=K.rowExpandLazyLoadedMaps,r=K.expandColumn,o=X.fullAllDataRowIdData,a=__assign({},l),l=y.value,i=l.reserve,u=l.lazy,c=l.accordion,d=l.toggleMethod,s=[],f=W.getColumnIndex(r),v=W.getVMColumnIndex(r);return e&&(_xeUtils.default.isArray(e)||(e=[e]),c&&(a={},e=e.slice(e.length-1,e.length)),l=d?e.filter(function(e){return d({$table:le,expanded:t,column:r,columnIndex:f,$columnIndex:v,row:e,rowIndex:W.getRowIndex(e),$rowIndex:W.getVMRowIndex(e)})}):e,t?l.forEach(function(e){var t,l=(0,_util.getRowid)(le,e);a[l]||(t=o[l],u&&!t.expandLoaded&&!n[l]?s.push(m(e)):a[l]=e)}):l.forEach(function(e){e=(0,_util.getRowid)(le,e);a[e]&&delete a[e]}),i)&&l.forEach(function(e){return L(e,t)}),K.rowExpandedMaps=a,Promise.all(s).then(function(){return W.recalculate()})},isRowExpandByRow:function(e){return!!K.rowExpandedMaps[(0,_util.getRowid)(le,e)]},isExpandByRow:function(e){return W.isRowExpandByRow(e)},clearRowExpand:function(){var e=X.tableFullData,t=y.value.reserve,l=W.getRowExpandRecords();return K.rowExpandedMaps={},t&&e.forEach(function(e){return L(e,!1)}),(0,_vue.nextTick)().then(function(){l.length&&W.recalculate()})},clearRowExpandReserve:function(){return X.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords:function(){var t=[];return _xeUtils.default.each(K.rowExpandedMaps,function(e){e&&t.push(e)}),t},getTreeExpandRecords:function(){var t=[];return _xeUtils.default.each(K.treeExpandedMaps,function(e){e&&t.push(e)}),t},isTreeExpandLoaded:function(e){e=X.fullAllDataRowIdData[(0,_util.getRowid)(le,e)];return e&&!!e.treeLoaded},clearTreeExpandLoaded:function(e){var t=K.treeExpandedMaps,l=X.fullAllDataRowIdData,n=te.value,r=n.transform,n=n.lazy,e=(0,_util.getRowid)(le,e),l=l[e];return n&&l&&(l.treeLoaded=!1,t[e])&&delete t[e],r?(b(),H.handleTableData()):(0,_vue.nextTick)()},reloadTreeExpand:function(e){var t=K.treeExpandLazyLoadedMaps,l=te.value,n=l.hasChild||l.hasChildField,r=l.transform,l=l.lazy,o=(0,_util.getRowid)(le,e);return l&&e[n]&&!t[o]&&W.clearTreeExpandLoaded(e).then(function(){return Ct(e)}).then(function(){if(r)return b(),H.handleTableData()}).then(function(){return W.recalculate()}),(0,_vue.nextTick)()},reloadTreeChilds:function(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadTreeChilds","reloadTreeExpand"]),W.reloadTreeExpand(e)},toggleTreeExpand:function(e){return W.setTreeExpand(e,!W.isTreeExpandByRow(e))},setAllTreeExpand:function(e){var t=X.tableFullData,l=te.value,n=l.transform,r=l.lazy,o=l.children||l.childrenField,a=[];return _xeUtils.default.eachTree(t,function(e){var t=e[o];(r||t&&t.length)&&a.push(e)},{children:o}),W.setTreeExpand(a,e).then(function(){if(n)return b(),W.recalculate()})},setTreeExpand:function(e,t){var l=te.value.transform;return e&&(e=_xeUtils.default.isArray(e)?e:[e]).length?l?u(e,t).then(function(){return b(),H.handleTableData()}).then(function(){return W.recalculate()}):u(e,t):(0,_vue.nextTick)()},isTreeExpandByRow:function(e){return!!K.treeExpandedMaps[(0,_util.getRowid)(le,e)]},clearTreeExpand:function(){var e=X.tableFullTreeData,t=te.value,l=t.children||t.childrenField,n=t.transform,t=t.reserve,r=W.getTreeExpandRecords();return K.treeExpandedMaps={},t&&_xeUtils.default.eachTree(e,function(e){return Et(e,!1)},{children:l}),H.handleTableData().then(function(){if(n)return b(),H.handleTableData()}).then(function(){if(r.length)return W.recalculate()})},clearTreeExpandReserve:function(){return X.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll:function(){var e=K.scrollXLoad,t=K.scrollYLoad,l=j.value.$el;return{virtualX:e,virtualY:t,scrollTop:l.scrollTop,scrollLeft:l.scrollLeft}},scrollTo:function(e,t){var l=j.value,n=Y.value,r=d.value,l=l?l.$el:null,r=r?r.$el:null,n=n?n.$el:null;return _xeUtils.default.isNumber(e)&&(0,_dom.setScrollLeft)(n||l,e),_xeUtils.default.isNumber(t)&&(0,_dom.setScrollTop)(r||l,t),K.scrollXLoad||K.scrollYLoad?new Promise(function(e){setTimeout(function(){(0,_vue.nextTick)(function(){e()})},50)}):(0,_vue.nextTick)()},scrollToRow:function(e,t){var l=[];return e&&(P.treeConfig?l.push(H.scrollToTreeRow(e)):l.push((0,_util.rowToVisible)(le,e))),t&&l.push(W.scrollToColumn(t)),Promise.all(l)},scrollToColumn:function(e){var t=X.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(le,e);return e&&t[e.id]?(0,_util.colToVisible)(le,e):(0,_vue.nextTick)()},clearScroll:function(){var e=X.scrollXStore,t=X.scrollYStore,l=j.value,n=Y.value,r=d.value,l=l?l.$el:null,r=r?r.$el:null,n=n?n.$el:null;return r&&((0,_util.restoreScrollListener)(r),r.scrollTop=0),n&&(n.scrollLeft=0),l&&((0,_util.restoreScrollListener)(l),l.scrollTop=0,l.scrollLeft=0),e.startIndex=0,(t.startIndex=0,_vue.nextTick)()},updateFooter:function(){var e=P.showFooter,t=P.footerMethod,l=X.visibleColumn,n=X.afterFullData;return e&&t&&(K.footerTableData=l.length?t({columns:l,data:n,$table:le,$grid:B}):[]),(0,_vue.nextTick)()},updateStatus:function(a,i){var u=!_xeUtils.default.isUndefined(i);return(0,_vue.nextTick)().then(function(){var e=P.editRules,t=K.validStore,l=j.value;if(a&&l&&e){var n=a.row,r=a.column;if(le.hasCellRules&&le.hasCellRules("change",n,r)){var o=H.getCell(n,r);if(o)return le.validCellRules("change",n,r,i).then(function(){u&&t.visible&&(0,_util.setCellValue)(n,r,i),le.clearValidate(n,r)}).catch(function(e){e=e.rule;u&&(0,_util.setCellValue)(n,r,i),le.showValidTooltip({rule:e,row:n,column:r,cell:o})})}}})},setMergeCells:function(e){return P.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),t(e,K.mergeList,X.afterFullData),(0,_vue.nextTick)().then(function(){return W.updateCellAreas()})},removeMergeCells:function(e){P.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);var t=l(e,K.mergeList,X.afterFullData);return(0,_vue.nextTick)().then(function(){return W.updateCellAreas(),t})},getMergeCells:function(){return K.mergeList.slice(0)},clearMergeCells:function(){return K.mergeList=[],(0,_vue.nextTick)()},setMergeFooterItems:function(e){return P.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]),t(e,K.mergeFooterList),(0,_vue.nextTick)().then(function(){return W.updateCellAreas()})},removeMergeFooterItems:function(e){P.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]);var t=l(e,K.mergeFooterList);return(0,_vue.nextTick)().then(function(){return W.updateCellAreas(),t})},getMergeFooterItems:function(){return K.mergeFooterList.slice(0)},clearMergeFooterItems:function(){return K.mergeFooterList=[],(0,_vue.nextTick)()},updateCellAreas:function(){var e=P.mouseConfig,t=Q.value;return e&&t.area&&le.handleUpdateCellAreas?le.handleUpdateCellAreas():(0,_vue.nextTick)()},focus:function(){return X.isActivated=!0,(0,_vue.nextTick)()},blur:function(){return(X.isActivated=!1,_vue.nextTick)()},connect:function(e){return e?(f=e).syncUpdate({collectColumn:X.collectColumn,$table:le}):(0,_log.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}},H={getSetupOptions:function(){return _conf.default},updateAfterDataIndex:k,callSlot:function(e,t){if(e){if(B)return B.callSlot(e,t);if(_xeUtils.default.isFunction(e))return(0,_vn.getSlotVNs)(e(t))}return[]},getParentElem:function(){var e,t=z.value;return B?(e=B.getRefMaps().refElem.value)?e.parentNode:null:t?t.parentNode:null},getParentHeight:function(){var e=P.height,t=z.value;return t?(t=t.parentNode,e="auto"===e?(0,_dom.getPaddingTopBottomSize)(t):0,Math.floor(B?B.getParentHeight():_xeUtils.default.toNumber(getComputedStyle(t).height)-e)):0},getExcludeHeight:function(){return B?B.getExcludeHeight():0},defineField:function(e){var t=P.treeConfig,l=y.value,n=te.value,o=E.value,a=R.value,i=n.children||n.childrenField,u=(0,_util.getRowkey)(le);return(e=_xeUtils.default.isArray(e)?e:[e]).map(function(r){return X.tableFullColumn.forEach(function(e){var t,l=e.field,n=e.editRender;!l||_xeUtils.default.has(r,l)||r[l]||(t=null,n&&(n=n.defaultValue,_xeUtils.default.isFunction(n)?t=n({column:e}):_xeUtils.default.isUndefined(n)||(t=n)),_xeUtils.default.set(r,l,t))}),[o.labelField,a.checkField,a.labelField,l.labelField].forEach(function(e){e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(r,e))&&_xeUtils.default.set(r,e,null)}),t&&n.lazy&&_xeUtils.default.isUndefined(r[i])&&(r[i]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(r,u))&&_xeUtils.default.set(r,u,(0,_util.getRowUniqueId)()),r})},handleTableData:function(e){var i,u,t,l,n,r,o,a,c,d,s,f,v,g,h,p=K.scrollYLoad,_=X.scrollYStore,m=X.fullDataRowIdData,x=X.afterFullData,w=(e&&(e=P.treeConfig,l=X.tableFullColumn,n=X.tableFullData,r=X.tableFullTreeData,o=je.value,a=T.value,c=te.value,d=c.transform,s=o.remote,f=o.filterMethod,v=a.remote,o=a.sortMethod,w=a.multiple,a=a.chronological,g=[],h=[],s&&v?e&&d?g=h=_xeUtils.default.searchTree(r,function(){return!0},__assign(__assign({},c),{original:!0})):h=g=(e?r:n).slice(0):(i=[],u=[],l.forEach(function(e){var t,l,n=e.field,r=e.sortable,o=e.order,a=e.filters;!s&&a&&a.length&&(t=[],l=[],a.forEach(function(e){e.checked&&(l.push(e),t.push(e.value))}),l.length)&&i.push({column:e,valueList:t,itemList:l}),!v&&r&&o&&u.push({column:e,field:n,property:n,order:o,sortTime:e.sortTime})}),w&&a&&1<u.length&&(u=_xeUtils.default.orderBy(u,"sortTime")),!s&&i.length?(l=function(u){return i.every(function(e){var t=e.column,l=e.valueList,e=e.itemList,n=t.filterMethod,r=t.filterRender,r=r?_vXETable.VXETable.renderer.get(r.name):null,o=r?r.filterMethod:null,a=r?r.defaultFilterMethod:null,i=(0,_util.getCellValue)(u,t);return n?e.some(function(e){return n({value:e.value,option:e,cellValue:i,row:u,column:t,$table:le})}):o?e.some(function(e){return o({value:e.value,option:e,cellValue:i,row:u,column:t,$table:le})}):f?f({options:e,values:l,cellValue:i,row:u,column:t}):a?e.some(function(e){return a({value:e.value,option:e,cellValue:i,row:u,column:t,$table:le})}):-1<l.indexOf(_xeUtils.default.get(u,t.field))})},e&&d?g=h=_xeUtils.default.searchTree(r,l,__assign(__assign({},c),{original:!0})):h=g=(e?r:n).filter(l)):e&&d?g=h=_xeUtils.default.searchTree(r,function(){return!0},__assign(__assign({},c),{original:!0})):h=g=(e?r:n).slice(0),!v&&u.length&&(e&&d?g=h=o?(t=o({data:h,sortList:u,$table:le}),_xeUtils.default.isArray(t)?t:h):_xeUtils.default.orderBy(h,u.map(function(e){var t=e.column,e=e.order;return[M(t),e]})):h=g=o?(t=o({data:g,sortList:u,$table:le}),_xeUtils.default.isArray(t)?t:g):_xeUtils.default.orderBy(g,u.map(function(e){var t=e.column,e=e.order;return[M(t),e]})))),X.afterFullData=g,X.afterTreeFullData=h,k(),x=b()),p?x.slice(_.startIndex,_.endIndex):x.slice(0));return w.forEach(function(e,t){e=(0,_util.getRowid)(le,e),e=m[e];e&&(e.$index=t)}),K.tableData=w,(0,_vue.nextTick)()},cacheRowMap:function(i){function e(e,t,l,n,r,o){var a=(0,_util.getRowid)(le,e),n=u&&n?(0,_util.toTreePathSeq)(n):t+1,o=o?o.length-1:0,e=((0,_utils.eqEmptyValue)(a)&&(a=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,v,a)),g&&e[f]&&_xeUtils.default.isUndefined(e[s])&&(e[s]=null),{row:e,rowid:a,seq:n,index:u&&r?-1:t,_index:-1,$index:-1,items:l,parent:r,level:o});i&&(c[a]=e),d[a]=e}var u=P.treeConfig,t=te.value,c=X.fullDataRowIdData,d=X.fullAllDataRowIdData,l=X.tableFullData,n=X.tableFullTreeData,s=t.children||t.childrenField,f=t.hasChild||t.hasChildField,v=(0,_util.getRowkey)(le),g=u&&t.lazy;i&&(c=X.fullDataRowIdData={}),d=X.fullAllDataRowIdData={},u?_xeUtils.default.eachTree(n,e,{children:s}):l.forEach(e)},cacheSourceMap:function(e){function t(e){var t=(0,_util.getRowid)(le,e);(0,_utils.eqEmptyValue)(t)&&(t=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,o,t)),r[t]=e}var l=P.treeConfig,n=te.value,r=X.sourceDataRowIdData,e=_xeUtils.default.clone(e,!0),o=(0,_util.getRowkey)(le),r=X.sourceDataRowIdData={};l?(l=n.children||n.childrenField,_xeUtils.default.eachTree(e,t,{children:n.transform?n.mapChildrenField:l})):e.forEach(t),X.tableSourceData=e},analyColumnWidth:function(){var e=X.tableFullColumn,t=G.value,l=t.width,n=t.minWidth,r=[],o=[],a=[],i=[],u=[],c=[];e.forEach(function(e){l&&!e.width&&(e.width=l),n&&!e.minWidth&&(e.minWidth=n),e.visible&&(e.resizeWidth?r:(0,_dom.isPx)(e.width)?o:(0,_dom.isScale)(e.width)?i:(0,_dom.isPx)(e.minWidth)?a:(0,_dom.isScale)(e.minWidth)?u:c).push(e)}),Object.assign(K.columnStore,{resizeList:r,pxList:o,pxMinList:a,scaleList:i,scaleMinList:u,autoList:c})},saveCustomResizable:function(e){var l,t=P.id,n=P.customConfig,r=v.value,o=X.collectColumn,r=r.storage,r=!0===r||r&&r.resizable;n&&r&&(n=g(resizableStorageKey),t?(e||(l=_xeUtils.default.isPlainObject(n[t])?n[t]:{},_xeUtils.default.eachTree(o,function(e){var t;e.resizeWidth&&(t=e.getKey())&&(l[t]=e.renderWidth)})),n[t]=_xeUtils.default.isEmpty(l)?void 0:l,localStorage.setItem(resizableStorageKey,_xeUtils.default.toJSONString(n))):(0,_log.errLog)("vxe.error.reqProp",["id"]))},saveCustomFixed:function(){var l,e=P.id,t=P.customConfig,n=X.collectColumn,r=v.value.storage,r=!0===r||r&&r.fixed;t&&r&&(t=g(fixedStorageKey),l=[],e?(_xeUtils.default.eachTree(n,function(e){var t;e.fixed&&e.fixed!==e.defaultFixed&&(t=e.getKey())&&l.push("".concat(t,"|").concat(e.fixed))}),t[e]=l.join(",")||void 0,localStorage.setItem(fixedStorageKey,_xeUtils.default.toJSONString(t))):(0,_log.errLog)("vxe.error.reqProp",["id"]))},saveCustomVisible:function(){var l,n,e=P.id,t=P.customConfig,r=X.collectColumn,o=v.value,a=o.checkMethod,o=o.storage,o=!0===o||o&&o.visible;t&&o&&(t=g(visibleStorageKey),l=[],n=[],e?(_xeUtils.default.eachTree(r,function(e){var t;a&&!a({column:e})||(!e.visible&&e.defaultVisible?(t=e.getKey())&&l.push(t):e.visible&&!e.defaultVisible&&(t=e.getKey())&&n.push(t))}),t[e]=[l.join(",")].concat(n.length?[n.join(",")]:[]).join("|")||void 0,localStorage.setItem(visibleStorageKey,_xeUtils.default.toJSONString(t))):(0,_log.errLog)("vxe.error.reqProp",["id"]))},handleCustom:function(){return H.saveCustomVisible(),H.analyColumnWidth(),W.refreshColumn()},handleUpdateDataQueue:function(){K.upDataFlag++},handleRefreshColumnQueue:function(){K.reColumnFlag++},preventEvent:function(t,e,l,n,r){var o;return _vXETable.VXETable.interceptor.get(e).some(function(e){return!1===e(Object.assign({$grid:B,$table:le,$event:t},l))})||n&&(o=n()),r&&r(),o},checkSelectionStatus:function(){var t,l,e=P.treeConfig,n=K.selectCheckboxMaps,r=K.treeIndeterminateMaps,o=X.afterFullData,a=R.value,i=a.checkField,u=a.checkStrictly,c=a.checkMethod,d=a.indeterminateField||a.halfField;u||(t=[],u=a=!(l=[]),u=i?(a=o.every(c?function(e){return c({row:e})?!!_xeUtils.default.get(e,i)&&(l.push(e),!0):(t.push(e),!0)}:function(e){return _xeUtils.default.get(e,i)})&&o.length!==t.length,e?d?!a&&o.some(function(e){return _xeUtils.default.get(e,i)||_xeUtils.default.get(e,d)||!!r[(0,_util.getRowid)(le,e)]}):!a&&o.some(function(e){return _xeUtils.default.get(e,i)||!!r[(0,_util.getRowid)(le,e)]}):d?!a&&o.some(function(e){return _xeUtils.default.get(e,i)||_xeUtils.default.get(e,d)}):!a&&o.some(function(e){return _xeUtils.default.get(e,i)})):(a=o.every(c?function(e){return c({row:e})?!!n[(0,_util.getRowid)(le,e)]&&(l.push(e),!0):(t.push(e),!0)}:function(e){return n[(0,_util.getRowid)(le,e)]})&&o.length!==t.length,e?!a&&o.some(function(e){e=(0,_util.getRowid)(le,e);return r[e]||n[e]}):!a&&o.some(function(e){return n[(0,_util.getRowid)(le,e)]})),K.isAllSelected=a,K.isIndeterminate=u)},handleSelectRow:function(e,l,n){var r,o,t,a,i,u,c,d,s=e.row,e=P.treeConfig,f=K.selectCheckboxMaps,v=K.treeIndeterminateMaps,g=__assign({},f),f=X.afterFullData,h=te.value,h=h.children||h.childrenField,p=R.value,_=p.checkField,m=p.checkStrictly,x=p.checkMethod,w=p.indeterminateField||p.halfField,p=(0,_util.getRowid)(le,s);if(_)if(e&&!m){if(-1===l?(v[p]||(w&&_xeUtils.default.set(s,w,!0),v[p]=s),_xeUtils.default.set(s,_,!1)):_xeUtils.default.eachTree([s],function(e){(le.eqRow(e,s)||n||!x||x({row:e}))&&(_xeUtils.default.set(e,_,l),w&&_xeUtils.default.set(s,w,!1),delete v[(0,_util.getRowid)(le,e)],C(s,l))},{children:h}),(a=_xeUtils.default.findTree(f,function(e){return le.eqRow(e,s)},{children:h}))&&a.parent)return i=void 0,r=[],o={},!n&&x?a.items.forEach(function(e){var t;x({row:e})&&(t=(0,_util.getRowid)(le,e),r.push(o[t]=e))}):a.items.forEach(function(e){var t=(0,_util.getRowid)(le,e);r.push(o[t]=e)}),i=_xeUtils.default.find(a.items,function(e){return!!v[(0,_util.getRowid)(le,e)]})?-1:(t=[],a.items.forEach(function(e){_xeUtils.default.get(e,_)&&t.push(e)}),t.filter(function(e){return o[(0,_util.getRowid)(le,e)]}).length===r.length||!(!t.length&&-1!==l)&&-1),K.selectCheckboxMaps=g,H.handleSelectRow({row:a.parent},i,n)}else!n&&x&&!x({row:s})||(_xeUtils.default.set(s,_,l),C(s,l));else if(e&&!m){if(-1===l?(v[p]||(w&&_xeUtils.default.set(s,w,!0),v[p]=s),g[p]&&delete g[p]):_xeUtils.default.eachTree([s],function(e){var t=(0,_util.getRowid)(le,e);(le.eqRow(e,s)||n||!x||x({row:e}))&&(l?g[t]=e:g[t]&&delete g[t],w&&_xeUtils.default.set(s,w,!1),delete v[(0,_util.getRowid)(le,e)],C(s,l))},{children:h}),(a=_xeUtils.default.findTree(f,function(e){return le.eqRow(e,s)},{children:h}))&&a.parent)return i=void 0,u=[],c={},!n&&x?a.items.forEach(function(e){var t;x({row:e})&&(t=(0,_util.getRowid)(le,e),u.push(c[t]=e))}):a.items.forEach(function(e){var t=(0,_util.getRowid)(le,e);u.push(c[t]=e)}),i=_xeUtils.default.find(a.items,function(e){return!!v[(0,_util.getRowid)(le,e)]})?-1:(d=[],a.items.forEach(function(e){var t=(0,_util.getRowid)(le,e);g[t]&&d.push(e)}),d.filter(function(e){return c[(0,_util.getRowid)(le,e)]}).length===u.length||!(!d.length&&-1!==l)&&-1),K.selectCheckboxMaps=g,H.handleSelectRow({row:a.parent},i,n)}else!n&&x&&!x({row:s})||(l?g[p]||(g[p]=s):g[p]&&delete g[p],C(s,l));K.selectCheckboxMaps=g,H.checkSelectionStatus()},triggerHeaderHelpEvent:function(t,e){var l,n,e=e.column,e=e.titlePrefix||e.titleHelp;(e.content||e.message)&&(l=K.tooltipStore,n=(0,_utils.getFuncText)(e.content||e.message),_e(!0),l.visible=!0,l.currOpts=__assign(__assign({},e),{content:null}),(0,_vue.nextTick)(function(){var e=q.value;e&&e.open(t.currentTarget,n)}))},triggerHeaderTooltipEvent:function(e,t){var l=K.tooltipStore,n=t.column,e=e.currentTarget;_e(!0),l.column===n&&l.visible||me(0,e,e,null,t)},triggerBodyTooltipEvent:function(e,t){var l=P.editConfig,n=K.editStore,r=K.tooltipStore,o=J.value,n=n.actived,a=t.row,i=t.column,e=e.currentTarget;if(_e(r.column!==i||r.row!==a),i.editRender&&(0,_utils.isEnableConf)(l)){if("row"===o.mode&&n.row===a)return;if(n.row===a&&n.column===i)return}r.column===i&&r.row===a&&r.visible||(o=l=void 0,i.treeNode?(l=e.querySelector(".vxe-tree-cell"),"html"===i.type&&(o=e.querySelector(".vxe-cell--html"))):o=e.querySelector("html"===i.type?".vxe-cell--html":".vxe-cell--label"),me(0,e,l||e.children[0],o,t))},triggerFooterTooltipEvent:function(e,t){var l=t.column,n=K.tooltipStore,e=e.currentTarget;_e(n.column!==l||!!n.row),n.column===l&&n.visible||me(0,e,e.querySelector(".vxe-cell--item")||e.children[0],null,t)},handleTargetLeaveEvent:function(){var e=s.value,t=q.value;t&&t.setActived(!1),e.enterable?X.tooltipTimeout=setTimeout(function(){(t=q.value)&&!t.isActived()&&W.closeTooltip()},e.leaveDelay):W.closeTooltip()},triggerHeaderCellClickEvent:function(e,t){var l=X._lastResizeTime,n=T.value,r=G.value,o=t.column,a=e.currentTarget,l=l&&l>Date.now()-300,i=(0,_dom.getEventTargetNode)(e,a,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,a,"vxe-cell--filter").flag;"cell"!==n.trigger||l||i||u||H.triggerSortEvent(e,o,c(o)),W.dispatchEvent("header-cell-click",Object.assign({triggerResizable:l,triggerSort:i,triggerFilter:u,cell:a},t),e),(r.isCurrent||P.highlightCurrentColumn)&&W.setCurrentColumn(o)},triggerHeaderCellDblclickEvent:function(e,t){W.dispatchEvent("header-cell-dblclick",Object.assign({cell:e.currentTarget},t),e)},triggerCellClickEvent:function(e,t){var l=P.highlightCurrentRow,n=P.editConfig,r=K.editStore,o=y.value,a=J.value,i=te.value,u=E.value,c=R.value,d=Z.value,r=r.actived,s=t.row,f=t.column,v=f.type,g=f.treeNode,h="radio"===v,p="checkbox"===v,v="expand"===v,_=e.currentTarget,m=h&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--radio").flag,x=p&&(0,_dom.getEventTargetNode)(e,_,"vxe-cell--checkbox").flag,w=g&&(0,_dom.getEventTargetNode)(e,_,"vxe-tree--btn-wrapper").flag,b=v&&(0,_dom.getEventTargetNode)(e,_,"vxe-table--expanded").flag;t=Object.assign({cell:_,triggerRadio:m,triggerCheckbox:x,triggerTreeNode:w,triggerExpandNode:b},t),!x&&!m&&(!b&&("row"===o.trigger||v&&"cell"===o.trigger)&&H.triggerRowExpandEvent(e,t),"row"===i.trigger||g&&"cell"===i.trigger)&&H.triggerTreeExpandEvent(e,t),w||(b||(!d.isCurrent&&!l||x||m||H.triggerCurrentRowEvent(e,t),!m&&("row"===u.trigger||h&&"cell"===u.trigger)&&H.triggerRadioRowEvent(e,t),!x&&("row"===c.trigger||p&&"cell"===c.trigger)&&H.handleToggleCheckRowEvent(e,t)),(0,_utils.isEnableConf)(n)&&("manual"===a.trigger?r.args&&r.row===s&&f!==r.column&&I(e,t):r.args&&s===r.row&&f===r.column||("click"===a.trigger||"dblclick"===a.trigger&&"row"===a.mode&&r.row===s)&&I(e,t))),W.dispatchEvent("cell-click",t,e)},triggerCellDblclickEvent:function(e,t){var l=P.editConfig,n=K.editStore,r=J.value,n=n.actived,o=e.currentTarget;t=Object.assign({cell:o},t),!(0,_utils.isEnableConf)(l)||"dblclick"!==r.trigger||n.args&&e.currentTarget===n.args.cell||("row"===r.mode?a("blur").catch(function(e){return e}).then(function(){le.handleActived(t,e).then(function(){return a("change")}).catch(function(e){return e})}):"cell"===r.mode&&le.handleActived(t,e).then(function(){return a("change")}).catch(function(e){return e})),W.dispatchEvent("cell-dblclick",t,e)},handleToggleCheckRowEvent:function(e,t){var l=K.selectCheckboxMaps,n=R.value.checkField,r=t.row,o=!1,o=n?!_xeUtils.default.get(r,n):!l[(0,_util.getRowid)(le,r)];e?H.triggerCheckRowEvent(e,t,o):H.handleSelectRow(t,o)},triggerCheckRowEvent:function(e,t,l){var n=R.value,r=t.row,o=X.afterFullData,a=n.checkMethod;if(n.isShiftKey&&e.shiftKey&&!P.treeConfig){n=W.getCheckboxRecords();if(n.length){var n=n[0],i=W.getVTRowIndex(r),n=W.getVTRowIndex(n);if(i!==n)return W.setAllCheckboxRow(!1),o=i<n?o.slice(i,n+1):o.slice(n,i+1),S(o,!0,!1),void W.dispatchEvent("checkbox-range-select",Object.assign({rangeRecords:o},t),e)}}a&&!a({row:r})||(H.handleSelectRow(t,l),W.dispatchEvent("checkbox-change",Object.assign({records:W.getCheckboxRecords(),reserves:W.getCheckboxReserveRecords(),indeterminates:W.getCheckboxIndeterminateRecords(),checked:l},t),e))},triggerCheckAllEvent:function(e,t){bt(t),e&&W.dispatchEvent("checkbox-all",{records:W.getCheckboxRecords(),reserves:W.getCheckboxReserveRecords(),indeterminates:W.getCheckboxIndeterminateRecords(),checked:t},e)},triggerRadioRowEvent:function(e,t){var l=K.selectRadioRow,n=t.row,r=E.value,o=l!==n;o?wt(n):r.strict||(o=l===n)&&(n=null,W.clearRadioRow()),o&&W.dispatchEvent("radio-change",__assign({oldValue:l,newValue:n},t),e)},triggerCurrentRowEvent:function(e,t){var l=K.currentRow,n=t.row,r=l!==n;W.setCurrentRow(n),r&&W.dispatchEvent("current-change",__assign({oldValue:l,newValue:n},t),e)},triggerRowExpandEvent:function(e,t){var l=K.rowExpandLazyLoadedMaps,n=K.expandColumn,r=y.value,t=t.row,r=r.lazy,o=(0,_util.getRowid)(le,t);r&&l[o]||(r=!W.isExpandByRow(t),l=W.getColumnIndex(n),o=W.getVMColumnIndex(n),W.setRowExpand(t,r),W.dispatchEvent("toggle-row-expand",{expanded:r,column:n,columnIndex:l,$columnIndex:o,row:t,rowIndex:W.getRowIndex(t),$rowIndex:W.getVMRowIndex(t)},e))},triggerTreeExpandEvent:function(e,t){var l=K.treeExpandLazyLoadedMaps,n=te.value,r=t.row,t=t.column,n=n.lazy,o=(0,_util.getRowid)(le,r);n&&l[o]||(n=!W.isTreeExpandByRow(r),l=W.getColumnIndex(t),o=W.getVMColumnIndex(t),W.setTreeExpand(r,n),W.dispatchEvent("toggle-tree-expand",{expanded:n,column:t,columnIndex:l,$columnIndex:o,row:r},e))},triggerSortEvent:function(e,t,l){var n=P.mouseConfig,r=T.value,o=Q.value,a=t.field;t.sortable&&(l&&t.order!==l?W.sort({field:a,order:l}):W.clearSort(r.multiple?t:null),l={$table:le,$event:e,column:t,field:a,property:a,order:t.order,sortList:W.getSortColumns(),sortTime:t.sortTime},n&&o.area&&le.handleSortEvent&&le.handleSortEvent(e,l),W.dispatchEvent("sort-change",l,e))},triggerScrollXEvent:function(){N()},triggerScrollYEvent:function(e){var t=X.scrollYStore,l=t.adaptive,n=t.offsetSize,t=t.visibleSize;(isWebkit&&l&&2*n+t<=40?oe:yt)(e)},scrollToTreeRow:function(t){var l,e=P.treeConfig,n=X.tableFullData,r=[];return e&&(e=(e=te.value).children||e.childrenField,n=_xeUtils.default.findTree(n,function(e){return le.eqRow(e,t)},{children:e}))&&(l=n.nodes).forEach(function(e,t){t<l.length-1&&!W.isTreeExpandByRow(e)&&r.push(W.setTreeExpand(e,!0))}),Promise.all(r).then(function(){return(0,_util.rowToVisible)(le,t)})},updateScrollYStatus:re,updateScrollXSpace:function(){var e=K.isGroup,n=K.scrollXLoad,r=K.scrollbarWidth,t=X.visibleColumn,l=X.scrollXStore,o=X.elemStore,a=X.tableWidth,i=$.value,u=j.value,c=Y.value,u=u?u.$el:null;u&&(i=i?i.$el:null,c=c?c.$el:null,i=i?i.querySelector(".vxe-table--header"):null,u=u.querySelector(".vxe-table--body"),c=c?c.querySelector(".vxe-table--footer"):null,t=t.slice(0,l.startIndex).reduce(function(e,t){return e+t.renderWidth},0),l="",n&&(l="".concat(t,"px")),i&&(i.style.marginLeft=e?"":l),u.style.marginLeft=l,c&&(c.style.marginLeft=l),["main"].forEach(function(l){["header","body","footer"].forEach(function(e){var t=o["".concat(l,"-").concat(e,"-xSpace")],t=t?t.value:null;t&&(t.style.width=n?"".concat(a+("header"===e?r:0),"px"):"")})}),(0,_vue.nextTick)(w))},updateScrollYSpace:function(){var e=K.scrollYLoad,t=X.scrollYStore,l=X.elemStore,n=X.afterFullData,r=t.startIndex,t=t.rowHeight,n=n.length*t,r=Math.max(0,r*t),o="",a="";e&&(o="".concat(r,"px"),a="".concat(n,"px")),["main","left","right"].forEach(function(t){var e=l["".concat(t,"-body-table")],e=e?e.value:null;e&&(e.style.marginTop=o),["header","body","footer"].forEach(function(e){e=l["".concat(t,"-").concat(e,"-ySpace")],e=e?e.value:null;e&&(e.style.height=a)})}),(0,_vue.nextTick)(w)},updateScrollXData:function(){(0,_vue.nextTick)(function(){Rt(),H.updateScrollXSpace()})},updateScrollYData:function(){(0,_vue.nextTick)(function(){H.handleTableData(),H.updateScrollYSpace()})},checkScrolling:function(){var e=Oe.value,t=Ae.value,l=j.value,l=l?l.$el:null;l&&(e&&(0<l.scrollLeft?(0,_dom.addClass):(0,_dom.removeClass))(e,"scrolling--middle"),t)&&(l.clientWidth<l.scrollWidth-Math.ceil(l.scrollLeft)?(0,_dom.addClass):(0,_dom.removeClass))(t,"scrolling--middle")},updateZindex:function(){P.zIndex?X.tZindex=P.zIndex:X.tZindex<(0,_utils.getLastZIndex)()&&(X.tZindex=(0,_utils.nextZIndex)())},handleCheckedCheckboxRow:S,triggerHoverEvent:function(e,t){t=t.row;H.setHoverRow(t)},setHoverRow:function(e){var t=(0,_util.getRowid)(le,e),l=z.value;H.clearHoverRow(),l&&_xeUtils.default.arrayEach(l.querySelectorAll('[rowid="'.concat(t,'"]')),function(e){return(0,_dom.addClass)(e,"row--hover")}),X.hoverRow=e},clearHoverRow:function(){var e=z.value;e&&_xeUtils.default.arrayEach(e.querySelectorAll(".vxe-body--row.row--hover"),function(e){return(0,_dom.removeClass)(e,"row--hover")}),X.hoverRow=null},getCell:function(e,t){var l,e=(0,_util.getRowid)(le,e),n=j.value,r=Ie.value,o=d.value;return t&&(t.fixed&&("left"===t.fixed?r&&(l=r.$el):o&&(l=o.$el)),l=l||n.$el)?l.querySelector('.vxe-body--row[rowid="'.concat(e,'"] .').concat(t.id)):null},getCellLabel:function(e,t){var l=t.formatter,n=(0,_util.getCellValue)(e,t),r=n;if(l){var o=void 0,a=X.fullAllDataRowIdData,i=(0,_util.getRowid)(le,e),u=t.id,c=a[i];if(c&&(o=(o=c.formatData)||(a[i].formatData={}),c)&&o[u]&&o[u].value===n)return o[u].label;var d,a={cellValue:n,row:e,rowIndex:W.getRowIndex(e),column:t,columnIndex:W.getColumnIndex(t)};r=_xeUtils.default.isString(l)?(d=_vXETable.VXETable.formats.get(l))&&d.cellFormatMethod?d.cellFormatMethod(a):"":_xeUtils.default.isArray(l)?(d=_vXETable.VXETable.formats.get(l[0]))&&d.cellFormatMethod?d.cellFormatMethod.apply(d,__spreadArray([a],l.slice(1),!1)):"":l(a),o&&(o[u]={value:n,label:r})}return r},findRowIndexOf:function(e,t){return t?_xeUtils.default.findIndexOf(e,function(e){return le.eqRow(e,t)}):-1},eqRow:function(e,t){return!(!e||!t||e!==t&&(0,_util.getRowid)(le,e)!==(0,_util.getRowid)(le,t))}};"development"===process.env.NODE_ENV&&("openExport,openPrint,exportData,openImport,importData,saveFile,readFile,importByFile,print".split(",").forEach(function(e){le[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["Export"])}}),"clearValidate,fullValidate,validate".split(",").forEach(function(e){le[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["Validator"])}})),Object.assign(le,W,H);function St(){var e=z.value;e&&e.clientWidth&&e.clientHeight&&W.recalculate()}var h,Dt=(0,_vue.ref)(0),Mt=((0,_vue.watch)(function(){return P.data?P.data.length:-1},function(){Dt.value++}),(0,_vue.watch)(function(){return P.data},function(){Dt.value++}),(0,_vue.watch)(Dt,function(){var n=X.inited,r=X.initStatus;U(P.data||[]).then(function(){var e=K.scrollXLoad,t=K.scrollYLoad,l=K.expandColumn;X.inited=!0,X.initStatus=!0,r||O(),n||A(),"development"===process.env.NODE_ENV&&(e||t)&&l&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),W.recalculate()})}),(0,_vue.ref)(0)),kt=((0,_vue.watch)(function(){return K.staticColumns.length},function(){Mt.value++}),(0,_vue.watch)(function(){return K.staticColumns},function(){Mt.value++}),(0,_vue.watch)(Mt,function(){o(K.staticColumns)}),(0,_vue.ref)(0)),It=((0,_vue.watch)(function(){return K.tableColumn.length},function(){kt.value++}),(0,_vue.watch)(function(){return K.tableColumn},function(){kt.value++}),(0,_vue.watch)(kt,function(){H.analyColumnWidth()}),(0,_vue.watch)(function(){return K.upDataFlag},function(){(0,_vue.nextTick)(function(){W.updateData()})}),(0,_vue.watch)(function(){return K.reColumnFlag},function(){(0,_vue.nextTick)(function(){W.refreshColumn()})}),(0,_vue.watch)(function(){return P.showHeader},function(){(0,_vue.nextTick)(function(){W.recalculate(!0).then(function(){return W.refreshScroll()})})}),(0,_vue.watch)(function(){return P.showFooter},function(){(0,_vue.nextTick)(function(){W.recalculate(!0).then(function(){return W.refreshScroll()})})}),(0,_vue.watch)(function(){return P.height},function(){(0,_vue.nextTick)(function(){return W.recalculate(!0)})}),(0,_vue.watch)(function(){return P.maxHeight},function(){(0,_vue.nextTick)(function(){return W.recalculate(!0)})}),(0,_vue.watch)(function(){return P.syncResize},function(e){e&&(St(),(0,_vue.nextTick)(function(){St(),setTimeout(St)}))}),(0,_vue.ref)(0)),Lt=((0,_vue.watch)(function(){return P.mergeCells?P.mergeCells.length:-1},function(){It.value++}),(0,_vue.watch)(function(){return P.mergeCells},function(){It.value++}),(0,_vue.watch)(It,function(){W.clearMergeCells(),(0,_vue.nextTick)(function(){P.mergeCells&&W.setMergeCells(P.mergeCells)})}),(0,_vue.ref)(0));(0,_vue.watch)(function(){return P.mergeFooterItems?P.mergeFooterItems.length:-1},function(){Lt.value++}),(0,_vue.watch)(function(){return P.mergeFooterItems},function(){Lt.value++}),(0,_vue.watch)(Lt,function(){W.clearMergeFooterItems(),(0,_vue.nextTick)(function(){P.mergeFooterItems&&W.setMergeFooterItems(P.mergeFooterItems)})}),_vXETable.VXETable.hooks.forEach(function(e){var e=e.setupTable;e&&(e=e(le))&&_xeUtils.default.isObject(e)&&Object.assign(le,e)}),H.preventEvent(null,"created",{$table:le}),(0,_vue.onActivated)(function(){W.recalculate().then(function(){return W.refreshScroll()}),H.preventEvent(null,"activated",{$table:le})}),(0,_vue.onDeactivated)(function(){X.isActivated=!1,H.preventEvent(null,"deactivated",{$table:le})}),(0,_vue.onMounted)(function(){(0,_vue.nextTick)(function(){var e,t=P.data,l=P.treeConfig,n=P.showOverflow,r=X.scrollXStore,o=X.scrollYStore,a=x.value,i=J.value,u=te.value,c=E.value,d=R.value,s=y.value,f=Z.value;if("development"===process.env.NODE_ENV&&(P.rowId||f.keyField||!(d.reserve||d.checkRowKeys||c.reserve||c.checkRowKey||s.expandRowKeys||u.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),P.editConfig&&(i.showStatus||i.showUpdateStatus||i.showInsertStatus)&&!P.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),!l||!u.showLine&&!u.line||(P.rowKey||f.useKey)&&n||(0,_log.warnLog)("vxe.error.reqProp",["row-config.useKey | show-overflow"]),l&&P.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),P.showFooter&&!P.footerMethod&&(0,_log.warnLog)("vxe.error.reqProp",["footer-method"]),c=P.exportConfig,s=P.importConfig,f=lt.value,n=nt.value,s&&n.types&&!n.importMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.globalConfs.importTypes,n.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types=".concat(n.types.join(",")),n.types.filter(function(e){return _xeUtils.default.includes(_vXETable.VXETable.globalConfs.importTypes,e)}).join(",")||_vXETable.VXETable.globalConfs.importTypes.join(",")]),c)&&f.types&&!f.exportMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.globalConfs.exportTypes,f.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types=".concat(f.types.join(",")),f.types.filter(function(e){return _xeUtils.default.includes(_vXETable.VXETable.globalConfs.exportTypes,e)}).join(",")||_vXETable.VXETable.globalConfs.exportTypes.join(",")]),"development"===process.env.NODE_ENV){var l=v.value,s=Q.value,n=Z.value;if(!P.id&&P.customConfig&&(!0===l.storage||l.storage&&l.storage.resizable||l.storage&&l.storage.visible)&&(0,_log.errLog)("vxe.error.reqProp",["id"]),P.treeConfig&&d.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),n.height&&!P.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!le.handleUpdateCellAreas&&(P.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),P.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),s.area))return void(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]);P.treeConfig&&u.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),P.treeConfig&&u.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),s.area&&s.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),s.area&&d.range&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","checkbox-config.range"]),P.treeConfig&&s.area&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),P.editConfig&&i.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["edit-config.activeMethod","edit-config.beforeEditMethod"]),P.treeConfig&&d.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),d.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"])}"development"===process.env.NODE_ENV&&(P.editConfig&&!le.insert&&(0,_log.errLog)("vxe.error.reqModule",["Edit"]),P.editRules&&!le.validate&&(0,_log.errLog)("vxe.error.reqModule",["Validator"]),(d.range||P.keyboardConfig||P.mouseConfig)&&!le.triggerCellMousedownEvent&&(0,_log.errLog)("vxe.error.reqModule",["Keyboard"]),P.printConfig||P.importConfig||P.exportConfig)&&!le.exportData&&(0,_log.errLog)("vxe.error.reqModule",["Export"]),Object.assign(o,{startIndex:0,endIndex:0,visibleSize:0,adaptive:!1!==a.adaptive}),Object.assign(r,{startIndex:0,endIndex:0,visibleSize:0}),U(t||[]).then(function(){t&&t.length&&(X.inited=!0,X.initStatus=!0,O(),A()),w()}),P.autoResize&&(c=$e.value.refreshDelay,f=z.value,l=H.getParentElem(),e=c?_xeUtils.default.throttle(function(){return W.recalculate(!0)},c,{leading:!0,trailing:!0}):null,h=(0,_resize.createResizeEvent)(e?function(){P.autoResize&&requestAnimationFrame(e)}:function(){P.autoResize&&W.recalculate(!0)}),f&&h.observe(f),l)&&h.observe(l)}),_event.GlobalEvent.on(le,"paste",ve),_event.GlobalEvent.on(le,"copy",ge),_event.GlobalEvent.on(le,"cut",he),_event.GlobalEvent.on(le,"mousedown",ue),_event.GlobalEvent.on(le,"blur",ce),_event.GlobalEvent.on(le,"mousewheel",de),_event.GlobalEvent.on(le,"keydown",fe),_event.GlobalEvent.on(le,"resize",pe),le.handleGlobalContextmenuEvent&&_event.GlobalEvent.on(le,"contextmenu",le.handleGlobalContextmenuEvent),H.preventEvent(null,"mounted",{$table:le})}),(0,_vue.onBeforeUnmount)(function(){h&&h.disconnect(),W.closeFilter(),le.closeMenu&&le.closeMenu(),H.preventEvent(null,"beforeUnmount",{$table:le})}),(0,_vue.onUnmounted)(function(){_event.GlobalEvent.off(le,"paste"),_event.GlobalEvent.off(le,"copy"),_event.GlobalEvent.off(le,"cut"),_event.GlobalEvent.off(le,"mousedown"),_event.GlobalEvent.off(le,"blur"),_event.GlobalEvent.off(le,"mousewheel"),_event.GlobalEvent.off(le,"keydown"),_event.GlobalEvent.off(le,"resize"),_event.GlobalEvent.off(le,"contextmenu"),H.preventEvent(null,"unmounted",{$table:le})});return le.renderVN=function(){var e=P.loading,t=P.stripe,l=P.showHeader,n=P.height,r=P.treeConfig,o=P.mouseConfig,a=P.showFooter,i=P.highlightCell,u=P.highlightHoverRow,c=P.highlightHoverColumn,d=P.editConfig,s=P.editRules,f=K.isGroup,v=K.overflowX,g=K.overflowY,h=K.scrollXLoad,p=K.scrollYLoad,_=K.scrollbarHeight,m=K.tableData,x=K.tableColumn,w=K.tableGroupColumn,b=K.footerTableData,C=K.initStore,E=K.columnStore,R=K.filterStore,T=E.leftList,E=E.rightList,y=V.loading,S=Xe.value,D=ze.value,M=te.value,k=Z.value,I=G.value,L=Re.value,F=dt.value,U=Q.value,A=We.value,O=at.value,N=et.value;return(0,_vue.h)("div",{ref:z,class:["vxe-table","vxe-table--render-default","tid_".concat(Ee),"border--".concat(F),((F={})["size--".concat(L)]=L,F["vaild-msg--".concat(D.msgMode)]=!!s,F["vxe-editable"]=!!d,F["old-cell-valid"]=s&&"obsolete"===_conf.default.cellVaildMode,F["cell--highlight"]=i,F["cell--selected"]=o&&U.selected,F["cell--area"]=o&&U.area,F["row--highlight"]=k.isHover||u,F["column--highlight"]=I.isHover||c,F["is--header"]=l,F["is--footer"]=a,F["is--group"]=f,F["is--tree-line"]=r&&(M.showLine||M.line),F["is--fixed-left"]=T.length,F["is--fixed-right"]=E.length,F["is--animat"]=!!P.animat,F["is--round"]=P.round,F["is--stripe"]=!r&&t,F["is--loading"]=e,F["is--empty"]=!e&&!m.length,F["is--scroll-y"]=g,F["is--scroll-x"]=v,F["is--virtual-x"]=h,F["is--virtual-y"]=p,F)],onKeydown:se},[(0,_vue.h)("div",{class:"vxe-table-slots"},V.default?V.default({}):[]),(0,_vue.h)("div",{class:"vxe-table--render-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--main-wrapper"},[l?(0,_vue.h)(_header.default,{ref:$,tableData:m,tableColumn:x,tableGroupColumn:w}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:j,tableData:m,tableColumn:x}),a?(0,_vue.h)(_footer.default,{ref:Y,footerTableData:b,tableColumn:x}):(0,_vue.createCommentVNode)()]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[T&&T.length&&v?xe("left"):(0,_vue.createCommentVNode)(),E&&E.length&&v?xe("right"):(0,_vue.createCommentVNode)()])]),(0,_vue.h)("div",{ref:Ve,class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},(L=ot.value,d={$table:le},V.empty?V.empty(d):(i=(i=L.name?_vXETable.VXETable.renderer.get(L.name):null)?i.renderEmpty:null)?(0,_vn.getSlotVNs)(i(L,d)):(0,_utils.getFuncText)(P.emptyText)||_conf.default.i18n("vxe.table.emptyText")))]),(0,_vue.h)("div",{class:"vxe-table--border-line"}),(0,_vue.h)("div",{ref:Ne,class:"vxe-table--resizable-bar",style:v?{"padding-bottom":"".concat(_,"px")}:null}),(0,_vue.h)(_index.default,{class:"vxe-table--loading",modelValue:e,icon:O.icon,text:O.text},y?{default:function(){return y({$table:le,$grid:B})}}:{}),C.filter?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-filter"),{ref:De,filterStore:R}):(0,_vue.createCommentVNode)(),C.import&&P.importConfig?(0,_vue.h)((0,_vue.resolveComponent)("vxe-import-panel"),{defaultOptions:K.importParams,storeData:K.importStore}):(0,_vue.createCommentVNode)(),C.export&&(P.exportConfig||P.printConfig)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-export-panel"),{defaultOptions:K.exportParams,storeData:K.exportStore}):(0,_vue.createCommentVNode)(),N?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-context-menu"),{ref:Me}):(0,_vue.createCommentVNode)(),Ce?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),{ref:ye,isArrow:!1,enterable:!1}):(0,_vue.createCommentVNode)(),Ce?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),__assign({ref:q},S)):(0,_vue.createCommentVNode)(),Ce&&P.editRules&&D.showMessage&&("default"===D.message?!n:"tooltip"===D.message)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),__assign({ref:Se,class:[{"old-cell-valid":s&&"obsolete"===_conf.default.cellVaildMode},"vxe-table--valid-error"]},"tooltip"===D.message||1===m.length?A:{})):(0,_vue.createCommentVNode)()])},(0,_vue.provide)("xecolgroup",null),(0,_vue.provide)("$xetable",le),le},render:function(){return this.renderVN()}});exports.default=_default;