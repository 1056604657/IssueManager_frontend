{
  "version": 3,
  "sources": ["../../@fast-crud/fast-extends/src/uploader/components/fs-files-format.vue", "../../@fast-crud/fast-extends/src/uploader/components/fs-files-format.vue"],
  "sourcesContent": ["<template>\n  <div class=\"fs-files-format\">\n    <template v-if=\"type === 'text'\">\n      <span v-for=\"item in itemsRef\" :key=\"item.url\" class=\"fs-files-item\">\n        <a :href=\"item.url\" target=\"_blank\" v-bind=\"a\">\n          {{ item.name }}\n        </a>\n      </span>\n    </template>\n    <template v-else>\n      <component\n        :is=\"ui.tag.name\"\n        v-for=\"item in itemsRef\"\n        :key=\"item.url\"\n        class=\"fs-tag-item\"\n        :type=\"item.color\"\n        v-bind=\"tag\"\n      >\n        <a :href=\"item.url\" target=\"_blank\" v-bind=\"a\">{{ item.name }}</a>\n      </component>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, Ref, ref, watch } from \"vue\";\nimport { useUi } from \"@fast-crud/fast-crud\";\n/**\n * 文件格式化展示组件\n */\nexport default defineComponent({\n  name: \"FsFilesFormat\",\n  props: {\n    /**\n     * 文件列表\n     * 支持格式： `url , {url} , [url1,url2] ,  [{url:url1},{url:url2}]`\n     */\n    modelValue: {},\n    // tag颜色，`【primary, success, warning, danger ,info】`\n    color: {\n      default: \"\"\n    },\n    // 展示类型`【text, tag】`\n    type: {\n      default: \"tag\" // `可选【text,tag】`\n    },\n    // 链接配置\n    a: {},\n    // tag配置\n    tag: {},\n    // 构建下载url方法，支持异步\n    buildUrl: {},\n    // 批量构建下载url方法，支持异步\n    buildUrls: {},\n    // 根据value构建文件名\n    getFileName: {}\n  } as any,\n  setup(props: any, ctx) {\n    const { ui } = useUi();\n    const getFileName = computed(() => {\n      return (\n        props.getFileName ||\n        function (url: any) {\n          if (typeof url !== \"string\") {\n            console.warn(\"获取文件名失败，请配置getFileName\");\n            return url;\n          }\n          if (url?.lastIndexOf(\"/\") >= 0) {\n            return url.substring(url.lastIndexOf(\"/\") + 1);\n          }\n          return url;\n        }\n      );\n    });\n    function getItem(value: any): any {\n      return {\n        url: undefined,\n        value: value,\n        name: getFileName.value(value),\n        color: props.color\n      };\n    }\n\n    async function buildFileListUrls(list: any[]) {\n      if (props.buildUrls) {\n        const values = list.map((item) => item.value);\n        const urls = await props.buildUrls(values);\n        for (let i = 0; i < list.length; i++) {\n          list[i].url = urls[i];\n        }\n      } else if (props.buildUrl) {\n        for (let item of list) {\n          item.url = await props.buildUrl(item.value);\n        }\n      } else {\n        for (let i = 0; i < list.length; i++) {\n          list[i].url = list[i].value;\n        }\n      }\n    }\n\n    async function buildItems() {\n      if (props.modelValue == null || props.modelValue === \"\") {\n        return [];\n      }\n      let valueArr = [];\n      if (typeof props.modelValue === \"string\") {\n        valueArr = [getItem(props.modelValue)];\n      } else if (props.modelValue instanceof Array) {\n        // 本来就是数组的\n        valueArr = [];\n        for (const val of props.modelValue) {\n          valueArr.push(getItem(val));\n        }\n      }\n      await buildFileListUrls(valueArr);\n      return valueArr;\n    }\n    const itemsRef: Ref = ref([]);\n    watch(\n      () => {\n        return props.modelValue;\n      },\n      async () => {\n        itemsRef.value = await buildItems();\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      ui,\n      itemsRef\n    };\n  }\n});\n</script>\n<style lang=\"less\">\n.fs-files-format {\n  display: flex;\n  flex-wrap: wrap;\n  .fs-form-item,\n  .fs-tag-item {\n    margin: 1px;\n    a {\n      text-decoration: none;\n    }\n  }\n  .tag-item {\n    margin-right: 10px;\n  }\n  .el-divider__text,\n  .el-link {\n    font-size: inherit;\n  }\n}\n</style>\n", "<template>\n  <div class=\"fs-files-format\">\n    <template v-if=\"type === 'text'\">\n      <span v-for=\"item in itemsRef\" :key=\"item.url\" class=\"fs-files-item\">\n        <a :href=\"item.url\" target=\"_blank\" v-bind=\"a\">\n          {{ item.name }}\n        </a>\n      </span>\n    </template>\n    <template v-else>\n      <component\n        :is=\"ui.tag.name\"\n        v-for=\"item in itemsRef\"\n        :key=\"item.url\"\n        class=\"fs-tag-item\"\n        :type=\"item.color\"\n        v-bind=\"tag\"\n      >\n        <a :href=\"item.url\" target=\"_blank\" v-bind=\"a\">{{ item.name }}</a>\n      </component>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, Ref, ref, watch } from \"vue\";\nimport { useUi } from \"@fast-crud/fast-crud\";\n/**\n * 文件格式化展示组件\n */\nexport default defineComponent({\n  name: \"FsFilesFormat\",\n  props: {\n    /**\n     * 文件列表\n     * 支持格式： `url , {url} , [url1,url2] ,  [{url:url1},{url:url2}]`\n     */\n    modelValue: {},\n    // tag颜色，`【primary, success, warning, danger ,info】`\n    color: {\n      default: \"\"\n    },\n    // 展示类型`【text, tag】`\n    type: {\n      default: \"tag\" // `可选【text,tag】`\n    },\n    // 链接配置\n    a: {},\n    // tag配置\n    tag: {},\n    // 构建下载url方法，支持异步\n    buildUrl: {},\n    // 批量构建下载url方法，支持异步\n    buildUrls: {},\n    // 根据value构建文件名\n    getFileName: {}\n  } as any,\n  setup(props: any, ctx) {\n    const { ui } = useUi();\n    const getFileName = computed(() => {\n      return (\n        props.getFileName ||\n        function (url: any) {\n          if (typeof url !== \"string\") {\n            console.warn(\"获取文件名失败，请配置getFileName\");\n            return url;\n          }\n          if (url?.lastIndexOf(\"/\") >= 0) {\n            return url.substring(url.lastIndexOf(\"/\") + 1);\n          }\n          return url;\n        }\n      );\n    });\n    function getItem(value: any): any {\n      return {\n        url: undefined,\n        value: value,\n        name: getFileName.value(value),\n        color: props.color\n      };\n    }\n\n    async function buildFileListUrls(list: any[]) {\n      if (props.buildUrls) {\n        const values = list.map((item) => item.value);\n        const urls = await props.buildUrls(values);\n        for (let i = 0; i < list.length; i++) {\n          list[i].url = urls[i];\n        }\n      } else if (props.buildUrl) {\n        for (let item of list) {\n          item.url = await props.buildUrl(item.value);\n        }\n      } else {\n        for (let i = 0; i < list.length; i++) {\n          list[i].url = list[i].value;\n        }\n      }\n    }\n\n    async function buildItems() {\n      if (props.modelValue == null || props.modelValue === \"\") {\n        return [];\n      }\n      let valueArr = [];\n      if (typeof props.modelValue === \"string\") {\n        valueArr = [getItem(props.modelValue)];\n      } else if (props.modelValue instanceof Array) {\n        // 本来就是数组的\n        valueArr = [];\n        for (const val of props.modelValue) {\n          valueArr.push(getItem(val));\n        }\n      }\n      await buildFileListUrls(valueArr);\n      return valueArr;\n    }\n    const itemsRef: Ref = ref([]);\n    watch(\n      () => {\n        return props.modelValue;\n      },\n      async () => {\n        itemsRef.value = await buildItems();\n      },\n      {\n        immediate: true\n      }\n    );\n\n    return {\n      ui,\n      itemsRef\n    };\n  }\n});\n</script>\n<style lang=\"less\">\n.fs-files-format {\n  display: flex;\n  flex-wrap: wrap;\n  .fs-form-item,\n  .fs-tag-item {\n    margin: 1px;\n    a {\n      text-decoration: none;\n    }\n  }\n  .tag-item {\n    margin-right: 10px;\n  }\n  .el-divider__text,\n  .el-link {\n    font-size: inherit;\n  }\n}\n</style>\n"],
  "mappings": "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",
  "names": ["_sfc_main", "defineComponent", "props", "ctx", "ui", "useUi", "getFileName", "computed", "url", "getItem", "value", "buildFileListUrls", "list", "values", "item", "urls", "i", "buildItems", "valueArr", "val", "itemsRef", "ref", "watch", "_sfc_render", "_ctx", "_cache", "$props", "$setup", "$data", "$options", "_hoisted_1", "_openBlock", "_createElementBlock", "_Fragment", "_renderList", "_createElementVNode", "_mergeProps", "_createBlock", "_resolveDynamicComponent", "_withCtx"]
}
